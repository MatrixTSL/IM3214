<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Potentiometers</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">
  <link rel="manifest" href="manifest.json">
  <script src="worksheet-core.js"></script>
  <script src="worksheet-tracking.js"></script>
  <script defer src="shared-navigation.js"></script>
  <script defer src="pwa-install.js"></script>
  <script defer src="image-zoom.js"></script>

</head>
<body>
  <!-- Main Content -->
  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-5.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Previous Worksheet</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Worksheet 6 - Potentiometers</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-7.html'">
            <span>Next Worksheet</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> 1. Introduction</h2>
      <div class="worksheet-content">
        <div class="introduction-content-wrapper">
          <div class="introduction-text">
            <p>A switch typically sends either a 24V or 0V signal to a controller input. A potentiometer, on the other hand, provides a variable voltage between 0V and 24V. Potentiometers are useful for setting values like light level, conveyor speed, or room temperature.</p>
          </div>
          <div class="introduction-image">
            <div class="system-diagram">
              <img src="assets/worksheets/ws6.png" alt="Potentiometer Control System">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Over To You Section -->
    <div class="worksheet-section over-to-you-section">
      <h2 class="section-header"><i class="fas fa-hands-helping"></i> 2. Over To You</h2>
      <div class="worksheet-content">
        <p><strong>Follow these steps to explore potentiometer control:</strong></p>

        <div class="steps-container">
          <div class="step-card" data-step="1">
            <div class="step-number">1</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Build the Potentiometer System</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="step-checkmark"></span>
                </label>
              </div>
              <div class="step-description">
                <p>Build the system shown in the diagram. Connect the potentiometer to the analogue input and test the variable voltage control.</p>
              </div>
            </div>
          </div>

          <div class="step-card" data-step="2">
            <div class="step-number">2</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Load Program 6</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="step-checkmark"></span>
                </label>
              </div>
              <div class="step-description">
                <p>Load the potentiometer control program onto your controller. This program reads the analogue input and adjusts the LED brightness accordingly.</p>
              </div>
            </div>
          </div>

          <div class="step-card" data-step="3">
            <div class="step-number">3</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Monitor the System Display</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="step-checkmark"></span>
                </label>
              </div>
              <div class="step-description">
                <p>Watch the display to see how the analogue input value changes as you adjust the potentiometer. Note the relationship between position and voltage.</p>
              </div>
            </div>
          </div>

          <div class="step-card" data-step="4">
            <div class="step-content">
              <div class="step-header">
                <h4>Test Variable Control</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="step-checkmark"></span>
                </label>
              </div>
              <div class="step-description">
                <p>Turn the potentiometer from minimum to maximum and observe how it affects the LED brightness. This demonstrates variable input control.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- So What Section -->
    <div class="worksheet-section so-what-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> 3. So What?</h2>
      <div class="worksheet-content">
        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-cogs"></i>
            <h3>Variable Input Control</h3>
          </div>
          <div class="card-content">
            <p>In industrial maintenance, digital inputs are often enough for basic control tasks like detecting switches or sensors. But when setting values such as motor speed, pressure limits, or temperature targets, a variable input is required.</p>
          </div>
        </div>

        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-bolt"></i>
            <h3>Analogue vs Digital</h3>
          </div>
          <div class="card-content">
            <p>Understanding the difference between analogue (variable) and digital (on/off) signals is crucial for troubleshooting. Potentiometers provide smooth, continuous control rather than just on/off switching.</p>
          </div>
        </div>

        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-list-ol"></i>
            <h3>Practical Applications</h3>
          </div>
          <div class="card-content">
            <p>Potentiometers are commonly used in electrical control panels to set current limits, adjust conveyor speeds, control lighting levels, and set temperature thresholds in industrial systems.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Key Takeaways Section -->
    <div class="worksheet-section key-takeaways-section">
      <h2 class="section-header"><i class="fas fa-list-check"></i> Key Takeaways</h2>
      <ul>
        <li>Potentiometers provide variable voltage control between 0V and 24V.</li>
        <li>Analogue inputs allow for smooth, continuous control rather than just on/off.</li>
        <li>Variable control is essential for setting speeds, limits, and thresholds.</li>
        <li>Understanding analogue vs digital signals helps with troubleshooting.</li>
        <li>Potentiometers are commonly used for user-adjustable settings in control panels.</li>
      </ul>
    </div>

    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-question-circle"></i> Questions & Answers</h2>
      <div class="questions-content">
        <div class="question-item" data-question="1">
          <h4>Question 1: What voltage range does a potentiometer typically provide?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-1" value="A" class="option-radio">
              <span class="option-text">A) 0V to 24V variable voltage</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="B" class="option-radio">
              <span class="option-text">B) Only 0V or 24V</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="C" class="option-radio">
              <span class="option-text">C) 230V AC</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="D" class="option-radio">
              <span class="option-text">D) 110V DC</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(1)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) 0V to 24V variable voltage.
          </div>
        </div>
        
        <div class="question-item" data-question="2">
          <h4>Question 2: What is the main advantage of potentiometers over switches?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-2" value="A" class="option-radio">
              <span class="option-text">A) They are cheaper</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="B" class="option-radio">
              <span class="option-text">B) They are more reliable</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="C" class="option-radio">
              <span class="option-text">C) They provide variable control instead of just on/off</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="D" class="option-radio">
              <span class="option-text">D) They use less power</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(2)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) They provide variable control instead of just on/off.
          </div>
        </div>
        
        <div class="question-item" data-question="3">
          <h4>Question 3: In industrial systems, potentiometers are commonly used for:</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-3" value="A" class="option-radio">
              <span class="option-text">A) Emergency stops</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="B" class="option-radio">
              <span class="option-text">B) Setting speeds, limits, and thresholds</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="C" class="option-radio">
              <span class="option-text">C) Power distribution</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="D" class="option-radio">
              <span class="option-text">D) Circuit protection</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(3)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) Setting speeds, limits, and thresholds.
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  
  <script>
    // Initialize everything when the DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
      loadSavedAnswers();
    });
    
        function submitAnswer(questionNumber) {
          const answerInput = document.querySelector(`[data-question="${questionNumber}"]`);
          if (!answerInput) return;
          
          const selectedOption = document.querySelector(`input[name="question-${questionNumber}"]:checked`);
          if (!selectedOption) {
            alert('Please select an answer before submitting.');
            return;
          }
          
          const answer = selectedOption.value;
          
          // Save with enhanced tracking
          worksheetTracker.saveAnswer(6, questionNumber, answer, 'maintenance');
          
          // Define correct answers for worksheet 6
          const correctAnswers = {
            1: 'A',
            2: 'C',
            3: 'B'
          };
          
          // Check if the answer is correct
          const isCorrect = correctAnswers[questionNumber] === answer;
          
          // Show the correct answer
          const correctAnswerDiv = answerInput.querySelector('.correct-answer');
          if (correctAnswerDiv) {
            correctAnswerDiv.style.display = 'block';
          }
          
          // Disable all options for this question
          const allOptions = answerInput.querySelectorAll('input[type="radio"]');
          allOptions.forEach(option => option.disabled = true);
          
          // Hide the submit button
          const submitBtn = answerInput.querySelector('.submit-question-btn');
          if (submitBtn) {
            submitBtn.style.display = 'none';
          }
          
          // Update tracking
          worksheetTracker.setQuestionCompleted(6, questionNumber, isCorrect);
          
          console.log(`Question ${questionNumber}: ${isCorrect ? 'Correct' : 'Incorrect'}`);
        }
        
        function loadSavedAnswers() {
          // This function is now handled by the tracking system
        }
  </script>
  
<script>
// Enhanced step tracking functionality
let isProcessing = false;

function initializeStepTracking() {
  console.log('Initializing step tracking...');
  
  // Wait for DOM to be fully ready
  setTimeout(() => {
    const stepCards = document.querySelectorAll('.step-card');
    console.log('Found step cards:', stepCards.length);
    
    stepCards.forEach((card, index) => {
      const stepNumber = index + 1;
      const checkbox = card.querySelector('.step-complete-checkbox');
      
      if (!checkbox) {
        console.log('No checkbox found for step', stepNumber);
        return;
      }
      
      console.log('Setting up step', stepNumber);
      
      // Load saved state
      const savedState = localStorage.getItem(`step-${stepNumber}`);
      if (savedState === 'true') {
        checkbox.checked = true;
        card.classList.add('step-completed');
        card.style.background = '#2a2a2a';
        card.style.opacity = '0.7';
        card.style.cursor = 'default';
      }
      
      // Enhanced checkbox change handler
      function handleCheckboxChange(checkbox, card, stepNumber) {
        console.log('Handling checkbox change for step', stepNumber, checkbox.checked);
        
        if (checkbox.checked) {
          card.classList.add('step-completed');
          card.style.background = '#2a2a2a';
          card.style.opacity = '0.7';
          card.style.cursor = 'default';
          localStorage.setItem(`step-${stepNumber}`, 'true');
        } else {
          card.classList.remove('step-completed');
          card.style.background = '';
          card.style.opacity = '';
          card.style.cursor = 'pointer';
          localStorage.setItem(`step-${stepNumber}`, 'false');
        }
      }
      
      // Add change handler to checkbox
      checkbox.addEventListener('change', function() {
        if (!isProcessing) {
          handleCheckboxChange(checkbox, card, stepNumber);
        }
      });
      
      // Add click handler to the entire card
      card.addEventListener('click', function(e) {
        console.log('Card clicked:', stepNumber);
        
        // Prevent double execution
        if (isProcessing) {
          console.log('Already processing, ignoring click');
          return;
        }
        
        // Don't toggle if clicking directly on the checkbox or its label
        if (e.target === checkbox || 
            e.target.closest('.step-checkbox') || 
            e.target.closest('label') ||
            e.target.tagName === 'INPUT' ||
            e.target.tagName === 'LABEL') {
          console.log('Clicking on checkbox or label, not toggling card');
          return;
        }
        
        // Prevent the default checkbox behavior and stop propagation
        e.preventDefault();
        e.stopPropagation();
        e.stopImmediatePropagation();
        
        // Set processing flag
        isProcessing = true;
        
        // Toggle the checkbox directly without triggering events
        checkbox.checked = !checkbox.checked;
        
        // Handle the change manually
        handleCheckboxChange(checkbox, card, stepNumber);
        
        // Reset processing flag after a small delay
        setTimeout(() => {
          isProcessing = false;
        }, 100);
      });
      
      // Also make the checkbox itself clickable
      checkbox.addEventListener('click', function(e) {
        e.stopPropagation();
        e.stopImmediatePropagation();
      });
    });
  }, 100);
}

// Initialize when page loads
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeStepTracking);
} else {
  initializeStepTracking();
}

// Also try again after a short delay to ensure everything is ready
setTimeout(initializeStepTracking, 500);

</script>
</body>
</html>
