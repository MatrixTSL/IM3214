<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Temperature Sensor</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">    <script src="worksheet-core.js"></script>
<script src="worksheet-tracking.js"></script>
  <script defer src="shared-navigation.js"></script>
  <script defer src="pwa-install.js"></script>

</head>
<body>


  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-8.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Previous Worksheet</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Worksheet 9 - Temperature Sensor</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-10.html'">
            <span>Next Worksheet</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> 1. Introduction</h2>
      <div class="worksheet-content">
        <div class="introduction-content-wrapper">
          <div class="introduction-text">
            <p>A temperature sensor tracks heat levels in real time to maintain safe and efficient system operation. Common in automation and process control, it helps prevent overheating or freezing. Engineers must understand these sensors to detect faults, ensure accurate readings, and avoid equipment damage or shutdowns.</p>
          </div>
          <div class="introduction-image">
            <div class="system-diagram">
              <img src="assets/maintenance/proximity-switch.png" alt="Proximity Switch System Maintenance">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Over To You Section -->
    <div class="worksheet-section over-to-you-section">
      <h2 class="section-header"><i class="fas fa-hands-helping"></i> 2. Over To You</h2>
      <div class="worksheet-content">
        <p><strong>Follow these steps to explore the temperature sensor and scaling:</strong></p>

        <div class="steps-container">
          <div class="step-card" data-step="1">
            <div class="step-number">1</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Open Worksheet 9</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Place your fingers on the temperature probe and observe the “Temp Sensor Raw” value change.</p>
            </div>
          </div>

          <div class="step-card" data-step="2">
            <div class="step-number">2</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Apply Scalar 10</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Add a scalar value of 10. Observe how the blue scaled value changes.</p>
            </div>
          </div>

          <div class="step-card" data-step="3">
            <div class="step-number">3</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Apply Scalar 1000</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Set scalar to 1000 and observe the much higher scaled value.</p>
            </div>
          </div>

          <div class="step-card" data-step="4">
            <div class="step-number">4</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Tune to Ambient</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Adjust the scalar until the value represents a sensible ambient temperature (20–40°C). The IO screen shows a suggested scalar.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- So What Section -->
    <div class="worksheet-section so-what-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> 3. So What?</h2>
      <div class="so-what-content">
        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-cogs"></i>
            <h3>Why this matters</h3>
          </div>
          <div class="card-content">
            <p>Temperature sensors keep equipment safe by preventing overheating and detecting faults. We are using a PT100 probe connected to an evaluation unit that converts resistance to a 0–10 V signal for the PLC. The PLC reads a raw value (0–27,648) and scales it to a real temperature.</p>
            <h3 style="margin-top:16px;">Key Takeaways</h3>
            <ul>
              <li>PT100 → evaluation unit → 0–10 V analogue input to PLC.</li>
              <li>Raw value range 0–27,648 must be scaled to °C.</li>
              <li>A reading near 32,000 indicates a fault (e.g., disconnected sensor).</li>
              <li>Accurate scaling is essential (typical room 20–40 °C).</li>
            </ul>
          </div>
        </div>
      </div>

    </div>

    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-question-circle"></i> Questions & Answers</h2>
      <div class="questions-content">
        <div class="question-item" data-question="1">
          <h4>Question 1: What is the main function of a proximity switch in an automated system?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-1" value="A" class="option-radio">
              <span class="option-text">A) To detect the presence of an object without physical contact, helping with automation, positioning, and safety</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="B" class="option-radio">
              <span class="option-text">B) To measure the temperature of objects</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="C" class="option-radio">
              <span class="option-text">C) To control the speed of motors</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="D" class="option-radio">
              <span class="option-text">D) To provide power to equipment</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(1)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) To detect the presence of an object without physical contact, helping with automation, positioning, and safety.
          </div>
        </div>
        
        <div class="question-item" data-question="2">
          <h4>Question 2: What type of object does an inductive proximity sensor detect?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-2" value="A" class="option-radio">
              <span class="option-text">A) It detects metal objects only</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="B" class="option-radio">
              <span class="option-text">B) It detects all types of objects</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="C" class="option-radio">
              <span class="option-text">C) It detects only plastic objects</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="D" class="option-radio">
              <span class="option-text">D) It detects only wooden objects</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(2)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) It detects only plastic objects.
          </div>
        </div>
        
        <div class="question-item" data-question="3">
          <h4>Question 3: Why is the proximity sensor used to detect the tank lid in this system?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-3" value="A" class="option-radio">
              <span class="option-text">A) To ensure the tank lid is in place before the system runs, preventing water from being pumped without the lid</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="B" class="option-radio">
              <span class="option-text">B) To measure the temperature of the lid</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="C" class="option-radio">
              <span class="option-text">C) To control the lid's position</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="D" class="option-radio">
              <span class="option-text">D) To provide power to the lid</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(3)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) To measure the temperature of the lid.
          </div>
        </div>
        
        <div class="question-item" data-question="4">
          <h4>Question 4: What are three types of proximity sensors and what do they detect?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-4" value="A" class="option-radio">
              <span class="option-text">A) Inductive (metal), capacitive (metal and non-metal), and photoelectric (uses light to detect objects)</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="B" class="option-radio">
              <span class="option-text">B) Magnetic, electrical, and mechanical</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="C" class="option-radio">
              <span class="option-text">C) Optical, thermal, and acoustic</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="D" class="option-radio">
              <span class="option-text">D) Digital, analog, and hybrid</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(4)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> D) Digital, analog, and hybrid.
          </div>
        </div>
        
        <div class="question-item" data-question="5">
          <h4>Question 5: What common issues can cause a proximity sensor to give false readings?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-5" value="A" class="option-radio">
              <span class="option-text">A) Misalignment, poor mounting, wiring faults, dust, or moisture</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="B" class="option-radio">
              <span class="option-text">B) High temperature, low pressure, or electrical noise</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="C" class="option-radio">
              <span class="option-text">C) Fast movement, slow movement, or no movement</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="D" class="option-radio">
              <span class="option-text">D) High voltage, low voltage, or no voltage</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(5)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) Fast movement, slow movement, or no movement.
          </div>
        </div>
      </div>
    </div>

    <!-- Simulation Section -->
    <div class="simulation-section">
      <h2 class="section-header"><i class="fas fa-cogs"></i> 3. Interactive Proximity Switch System Maintenance</h2>
      
      <!-- Introduction -->
      <div class="simulation-intro" style="background: #2a2a2a; padding: 20px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px;">
        <h3 style="color: #2196F3; margin-top: 0;"><i class="fas fa-info-circle"></i> Understanding Proximity Sensors</h3>
        <p style="color: #aaa; margin: 10px 0;">This simulation demonstrates how an inductive proximity sensor works in an industrial setting. Follow the steps below to learn about sensor operation, detection ranges, and proper positioning.</p>
      </div>

      <!-- Main Simulation Area -->
      <div class="simulation-container" style="display: grid; grid-template-columns: 300px 1fr; gap: 20px; margin: 20px 0;">
        <!-- Control Panel -->
        <div class="control-panel" style="background: #2a2a2a; padding: 20px; border-radius: 12px; border: 1px solid #333;">
          <h4 style="color: #2196F3; margin-top: 0;">Sensor Controls</h4>
          
          <!-- Target Position Control -->
          <div style="margin: 20px 0;">
            <label style="color: #aaa; display: block; margin-bottom: 10px;">Target Distance (mm)</label>
            <input type="range" id="target-distance" min="0" max="60" value="20" step="1" 
                   style="width: 100%; background: #2196F3; height: 10px; border-radius: 5px; -webkit-appearance: none;">
            <div style="display: flex; justify-content: space-between; margin-top: 5px;">
              <span style="color: #666;">0mm</span>
              <span id="distance-value" style="color: #2196F3;">50mm</span>
              <span style="color: #666;">100mm</span>
            </div>
          </div>

          <!-- Status Display -->
          <div class="sensor-status" style="margin-top: 20px; padding: 15px; background: #1a1a1a; border-radius: 5px;">
            <p style="margin: 0; color: #aaa;">Sensor Status: <span id="sensor-state" style="color: #FF5722;">Not Detecting</span></p>
            <p style="margin: 10px 0; color: #aaa;">Detection Range: <span style="color: #4CAF50;">0-40mm</span></p>
            <p style="margin: 10px 0; color: #aaa;">Current Distance: <span id="current-distance" style="color: #2196F3;">50mm</span></p>
          </div>

          <!-- Step Progress -->
          <div class="step-progress" style="margin-top: 20px;">
            <h5 style="color: #aaa; margin: 0 0 10px 0;">Learning Progress:</h5>
            <div class="progress-steps">
              <div class="step" style="padding: 10px; background: #1a1a1a; border-radius: 5px; margin-bottom: 10px;">
                <span style="color: #aaa;">1. Basic Detection</span>
                <span id="step1-complete" style="float: right; color: #FF5722;">❌</span>
              </div>
              <div class="step" style="padding: 10px; background: #1a1a1a; border-radius: 5px; margin-bottom: 10px;">
                <span style="color: #aaa;">2. Range Testing</span>
                <span id="step2-complete" style="float: right; color: #FF5722;">❌</span>
              </div>
              <div class="step" style="padding: 10px; background: #1a1a1a; border-radius: 5px;">
                <span style="color: #aaa;">3. Hysteresis Check</span>
                <span id="step3-complete" style="float: right; color: #FF5722;">❌</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Visualization Area -->
        <div style="background: #2a2a2a; padding: 20px; border-radius: 12px; border: 1px solid #333;">
          <div style="margin-bottom: 20px;">
            <h4 style="color: #2196F3; margin-top: 0;">Current Task</h4>
            <div id="task-description" style="color: #aaa; padding: 15px; background: #1a1a1a; border-radius: 5px;">
              Move the target into the detection range (0-40mm) to see how the sensor responds.
            </div>
          </div>
          
          <!-- Sensor Visualization -->
          <div class="sensor-visualization" style="position: relative; height: 200px; background: #1a1a1a; border-radius: 8px; overflow: hidden; margin-bottom: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.2);">
            <!-- Sensor body with detection face -->
            <div id="sensor-body" style="position: absolute; left: 40px; top: 50%; transform: translateY(-50%); width: 30px; height: 80px; background: #666; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
              <div id="sensor-face" style="width: 20px; height: 20px; background: #2196F3; border-radius: 50%; position: absolute; right: -10px; top: 50%; transform: translateY(-50%); box-shadow: 0 0 10px rgba(33, 150, 243, 0.5);"></div>
            </div>
            <!-- Detection zone (0-40mm range) -->
            <div id="detection-zone" style="position: absolute; left: 70px; top: 50%; transform: translateY(-50%); height: 100px; border: 2px dashed #2196F3; border-radius: 5px; opacity: 0.1;"></div>
            <!-- Target object -->
            <div id="target-object" style="position: absolute; left: 150px; top: 50%; transform: translateY(-50%); width: 30px; height: 30px; background: #FF5722; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
            <!-- Distance scale -->
            <div style="position: absolute; bottom: 10px; left: 70px; right: 40px; height: 20px; display: flex; justify-content: space-between; color: #888; font-size: 12px; font-weight: 500;">
              <span>0mm</span>
              <span>20mm</span>
              <span>40mm</span>
            </div>
          </div>

          <!-- Detection Graph -->
          <div style="margin-top: 20px; background: #1a1a1a; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.2);">
            <canvas id="detection-chart" height="200"></canvas>
          </div>
        </div>
      </div>

      <!-- Learning Steps -->
      <div class="learning-steps" style="margin-top: 40px;">
        <h3 style="color: #4CAF50; margin-top: 0;"><i class="fas fa-graduation-cap"></i> Learning Steps</h3>
        
        <!-- Step 1 -->
        <div class="learning-step" style="background: #2a2a2a; padding: 20px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px;">
          <h4 style="color: #2196F3; margin-top: 0;">Step 1: Basic Detection</h4>
          <p style="color: #aaa;">Move the target in and out of the detection zone to understand how the sensor responds. The sensor will activate when a metal target enters its detection range.</p>
          <ul style="color: #aaa; margin: 10px 0;">
            </strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-lightbulb"></i>
              </div>
              <div class="key-point-content">
                <strong>Detection Range: 0-40mm</li>
            </strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-lightbulb"></i>
              </div>
              <div class="key-point-content">
                <strong>Sensor Type: Inductive (detects metal objects)</li>
            </strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-lightbulb"></i>
              </div>
              <div class="key-point-content">
                <strong>Output: Digital (ON/OFF)</li>
          </strong>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 2 -->
        <div class="learning-step" style="background: #2a2a2a; padding: 20px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px;">
          <h4 style="color: #2196F3; margin-top: 0;">Step 2: Range Testing</h4>
          <p style="color: #aaa;">Test the sensor at different distances to understand its reliable detection range. Note that the signal strength decreases with distance.</p>
          <ul style="color: #aaa; margin: 10px 0;">
            </strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-lightbulb"></i>
              </div>
              <div class="key-point-content">
                <strong>Optimal Range: 0-32mm (80% of rated)</li>
            </strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-lightbulb"></i>
              </div>
              <div class="key-point-content">
                <strong>Maximum Range: 40mm</li>
            </strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-lightbulb"></i>
              </div>
              <div class="key-point-content">
                <strong>Best Practice: Mount at 50-75% of rated range</li>
          </strong>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 3 -->
        <div class="learning-step" style="background: #2a2a2a; padding: 20px; border-radius: 12px; border: 1px solid #333;">
          <h4 style="color: #2196F3; margin-top: 0;">Step 3: Understanding Hysteresis</h4>
          <p style="color: #aaa;">Observe how the sensor has slightly different ON and OFF points. This hysteresis prevents chattering when the target is near the threshold.</p>
          <ul style="color: #aaa; margin: 10px 0;">
            </strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-lightbulb"></i>
              </div>
              <div class="key-point-content">
                <strong>ON Point: 40mm (moving in)</li>
            </strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-lightbulb"></i>
              </div>
              <div class="key-point-content">
                <strong>OFF Point: 42mm (moving out)</li>
            </strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-lightbulb"></i>
              </div>
              <div class="key-point-content">
                <strong>Hysteresis: 2mm difference</li>
          </strong>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </div>



  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="proximity-switch-simulation.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const initFunc = 'initializeProximitySwitchSimulation';
      setTimeout(() => {
        if (typeof window[initFunc] === 'function') {
          console.log('Initializing', initFunc);
          window[initFunc]();
        } else {
          document.querySelector('.simulation-loading').innerHTML = '<p>Simulation ready - Proximity Switch System Maintenance</p>';
        }
      }, 1000);
      loadSavedAnswers();
    });
    
        function submitAnswer(questionNumber) {
          const answerInput = document.querySelector(`[data-question="${questionNumber}"]`);
          if (!answerInput) return;
          
          const selectedOption = document.querySelector(`input[name="question-${questionNumber}"]:checked`);
          if (!selectedOption) {
            alert('Please select an answer before submitting.');
            return;
          }
          
          const answer = selectedOption.value;
          
          // Save with enhanced tracking
          worksheetTracker.saveAnswer(9, questionNumber, answer, 'maintenance');
          
          // Define correct answers for worksheet 9
          const correctAnswers = {
                "1": "A",
                "2": "C",
                "3": "B",
                "4": "D",
                "5": "C"
          };
          
          // Apply visual feedback
          const allOptions = answerInput.querySelectorAll('.option-label');
          const correctAnswer = correctAnswers[questionNumber];
          
          allOptions.forEach(option => {
            const radio = option.querySelector('.option-radio');
            const optionValue = radio.value;
            
            if (optionValue === correctAnswer) {
              option.classList.add('correct');
            } else if (optionValue === answer && answer !== correctAnswer) {
              option.classList.add('incorrect');
            }
          });
          
          // Mark question as submitted to disable further interaction
          answerInput.classList.add('submitted');
          
          // Show feedback on button
          const submitBtn = answerInput.querySelector('.submit-question-btn');
          if (submitBtn) {
            const originalText = submitBtn.textContent;
            submitBtn.textContent = answer === correctAnswer ? 'Correct!' : 'Incorrect!';
            submitBtn.style.background = answer === correctAnswer ? '#4CAF50' : '#f44336';
            
            // Add incorrect class for enhanced styling
            if (answer !== correctAnswer) {
              submitBtn.classList.add('incorrect');
            }
            
            setTimeout(() => {
              submitBtn.textContent = originalText;
              submitBtn.style.background = '#4CAF50';
              submitBtn.classList.remove('incorrect');
            }, 2000);
          }
          
          // Show correct answer if available
          const correctAnswerDiv = answerInput.querySelector('.correct-answer');
          if (correctAnswerDiv) {
            correctAnswerDiv.style.display = 'block';
          }
        }
    function loadSavedAnswers() {
      // This function is now handled by the tracking system
    }
    function loadSavedAnswers() {
      // This function is now handled by the tracking system
    }
  </script>
  
  <!-- Bottom Navigation -->
  <div class="worksheet-bottom-nav">
    <div class="worksheet-header-content">
      <div class="worksheet-header-left">
        <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-8.html'">
          <i class="fas fa-arrow-left"></i>
          <span>Previous Worksheet</span>
        </button>
      </div>
       <div class="worksheet-header-center">
       <h1 class="worksheet-title">Worksheet 9 - Temperature Sensor</h1>
      </div>
      <div class="worksheet-header-right">
        <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-10.html'">
          <span>Next Worksheet</span>
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
  
<script>

// Enhanced answer handling functions
function submitAnswer(questionNumber) {
  const answerInput = document.querySelector(`[data-question="${questionNumber}"]`);
  if (!answerInput) return;
  
  const selectedOption = document.querySelector(`input[name="question-${questionNumber}"]:checked`);
  if (!selectedOption) {
    alert('Please select an answer before submitting.');
    return;
  }
  
  const answer = selectedOption.value;
  
  // Save with enhanced tracking if available
  if (typeof worksheetTracker !== 'undefined') {
    const worksheetId = getUrlParameter('id') || getWorksheetIdFromUrl();
    const path = window.location.pathname;
    const isFaultScenario = path.includes('fault-scenario');
    const type = getUrlParameter('type') || (isFaultScenario ? 'fault' : 'maintenance');
    worksheetTracker.saveAnswer(worksheetId, questionNumber, answer, type);
  } else {
    saveAnswer(questionNumber, answer);
  }
  
  // Get correct answer from the correct-answer div
  const correctAnswerDiv = answerInput.querySelector('.correct-answer');
  let correctAnswerText = '';
  if (correctAnswerDiv) {
    const strongElement = correctAnswerDiv.querySelector('strong');
    if (strongElement) {
      correctAnswerText = strongElement.nextSibling.textContent.trim();
    }
  }
  
  // Determine if answer is correct (extract letter from correct answer)
  const correctLetter = correctAnswerText.match(/^[A-D]/);
  const isCorrect = correctLetter && answer === correctLetter;
  
  // Style the selected option
  const allOptions = answerInput.querySelectorAll('.option-label');
  allOptions.forEach(option => {
    option.classList.remove('correct', 'incorrect');
  });
  
  if (isCorrect) {
    selectedOption.closest('.option-label').classList.add('correct');
  } else {
    selectedOption.closest('.option-label').classList.add('incorrect');
    // Also mark the correct option as correct
    const correctOption = answerInput.querySelector(`input[name="question-${questionNumber}"][value="${correctLetter}"]`);
    if (correctOption) {
      correctOption.closest('.option-label').classList.add('correct');
    }
  }
  
  const submitBtn = answerInput.querySelector('.submit-question-btn');
  if (submitBtn) {
    submitBtn.textContent = isCorrect ? 'Correct!' : 'Incorrect';
    submitBtn.style.background = isCorrect ? '#4CAF50' : '#f44336';
    setTimeout(() => {
      submitBtn.textContent = 'Submit Answer';
      submitBtn.style.background = '#4CAF50';
    }, 2000);
  }
  
  // Show correct answer
  if (correctAnswerDiv) {
    correctAnswerDiv.style.display = 'block';
  }
}


// Enhanced step tracking functions
function initializeStepTracking() {
  console.log('Initializing step tracking...');
  
  // Wait a bit to ensure DOM is ready
  setTimeout(() => {
    const stepCards = document.querySelectorAll('.step-card');
    console.log('Found', stepCards.length, 'step cards');
    
    stepCards.forEach((card, index) => {
      const checkbox = card.querySelector('.step-complete-checkbox');
      const stepNumber = card.getAttribute('data-step') || (index + 1);
      
      console.log('Setting up card', stepNumber, 'with checkbox:', !!checkbox);
      
      if (checkbox) {
        // Load saved state
        const savedState = localStorage.getItem(`step-${stepNumber}`);
        if (savedState === 'true') {
          checkbox.checked = true;
          card.classList.add('step-completed');
        }
        
        // Make the entire card clickable
        card.style.cursor = 'pointer';
        
        // Add click handler to the entire card
        card.addEventListener('click', function(e) {
          console.log('Card clicked:', stepNumber);
          
          // Don't toggle if clicking directly on the checkbox
          if (e.target === checkbox || e.target.closest('.step-checkbox')) {
            return;
          }
          
          // Toggle the checkbox
          checkbox.checked = !checkbox.checked;
          
          // Trigger change event
          const changeEvent = new Event('change', { bubbles: true });
          checkbox.dispatchEvent(changeEvent);
          
          console.log('Checkbox toggled to:', checkbox.checked);
        });
        
        // Add change handler to checkbox
        checkbox.addEventListener('change', function() {
          console.log('Checkbox changed:', stepNumber, 'checked:', checkbox.checked);
          
          if (checkbox.checked) {
            card.classList.add('step-completed');
            localStorage.setItem(`step-${stepNumber}`, 'true');
          } else {
            card.classList.remove('step-completed');
            localStorage.setItem(`step-${stepNumber}`, 'false');
          }
        });
        
        // Also make the checkbox itself clickable
        checkbox.addEventListener('click', function(e) {
          e.stopPropagation(); // Prevent card click when clicking checkbox
        });
      }
    });
  }, 100);
}

// Initialize when page loads
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeStepTracking);
} else {
  // DOM is already loaded
  initializeStepTracking();
}

// Also try again after a short delay to ensure everything is ready
setTimeout(initializeStepTracking, 500);


</script>
</body>
</html> 