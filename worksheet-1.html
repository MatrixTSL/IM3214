<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix PLC LOGO! Module - Basic Outputs</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">
  <link rel="manifest" href="manifest.json">
  <script src="worksheet-core.js"></script>
  <script src="worksheet-tracking.js"></script>
  <script defer src="shared-navigation.js"></script>
  <script defer src="pwa-install.js"></script>
  <style>
    /* Enhanced step card styling for better clickability */
    .step-card {
      transition: all 0.3s ease !important;
      cursor: pointer !important;
      position: relative !important;
      overflow: hidden !important;
      background: #333 !important;
    }
    
    .step-card:hover {
      transform: translateY(-2px) !important;
      box-shadow: 0 4px 15px rgba(74, 158, 255, 0.3) !important;
      border-color: var(--accent-color) !important;
      background: #3a3a3a !important;
    }
    
    .step-card:active {
      transform: translateY(0px) !important;
      box-shadow: 0 2px 8px rgba(74, 158, 255, 0.2) !important;
    }
    
    .step-card.step-completed {
      background: #2a2a2a !important;
      opacity: 0.7 !important;
      cursor: default !important;
      border-left-color: #666 !important;
    }
    
    .step-card.step-completed:hover {
      transform: none !important;
      box-shadow: none !important;
      background: #2a2a2a !important;
    }
    
    /* Make sure the checkbox area doesn't interfere */
    .step-checkbox {
      pointer-events: auto !important;
      z-index: 10 !important;
    }
    
    .step-complete-checkbox {
      pointer-events: auto !important;
    }
  </style>
</head>
<body>


  <!-- Main Content -->
  <div class="worksheet-box">
    <!-- Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='CP6211-worksheets.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Back to Worksheets</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Worksheet 1 - Basic Outputs</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-2.html'">
            <span>Next Worksheet</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Introduction Section -->
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> Introduction</h2>
      <div class="worksheet-content">
        <div class="introduction-content-wrapper">
          <div class="introduction-text">
            <p>Modern industrial control systems, including PLCs, typically provide two types of outputs: low-current transistor outputs and high-current relay outputs. Transistor outputs are fast and ideal for driving signals to other control devices, but they can't handle much current directly. Relay outputs, while slower due to their mechanical switching, are robust and better suited to driving loads like pumps, solenoids, or indicator beacons found in maintenance systems.</p>
          </div>
          <div class="introduction-image">
            <div class="system-diagram">
              <img src="assets/maintenance/ws1.png" alt="Industrial Warning Beacon and PLC Output System">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Over To You Section -->
    <div class="worksheet-section over-to-you-section">
      <h2 class="section-header"><i class="fas fa-hands-helping"></i> 2. Over To You</h2>
      <div class="worksheet-content">
        <p><strong>Assemble the Locktronics system and explore PLC output types. This system demonstrates how PLCs control different types of outputs using transistor and relay switching.</strong></p>
        
        <div class="steps-container">
          <div class="step-card" data-step="1">
            <div class="step-number">1</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Assemble the Locktronics System</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Assemble the Locktronics system as shown in the diagram. Connect the LOGO! PLC to the modular components using the quick-release connectors.</p>
            </div>
          </div>
          
          <div class="step-card" data-step="2">
            <div class="step-number">2</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Load Program 1</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Load Program 1 onto the LOGO! PLC. This program will cycle through outputs 1 to 4, turning each one on in sequence.</p>
            </div>
          </div>
          
          <div class="step-card" data-step="3">
            <div class="step-number">3</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Observe Output Sequence</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Watch as the program cycles through outputs 1 to 4, turning each LED on in sequence. Observe how each output responds.</p>
            </div>
          </div>
          
          <div class="step-card" data-step="4">
            <div class="step-number">4</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Monitor PLC Status Display</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>The LOGO! PLC's screen displays the status of each output during operation. Watch the screen to see which outputs are active.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- So What Section -->
    <div class="worksheet-section so-what-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> 3. So What?</h2>
      <div class="so-what-content">
        <!-- Main Explanation Card -->
        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-cogs"></i>
            <h3>PLC Output Types</h3>
          </div>
          <div class="card-content">
            <p>In industrial maintenance, understanding the output capabilities of your PLC is essential. Transistor outputs vary between models, so always check the voltage and current ratings before connecting equipment. When a controller can't drive a load directly such as a motor, solenoid, or warning light, external relays are used to handle the higher current.</p>
          </div>
        </div>

        <!-- System Behavior Card -->
        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-chart-line"></i>
            <h3>Electrical Isolation & Safety</h3>
          </div>
          <div class="card-content">
            <p>Even with a common ground, relays provide electrical isolation between the control and power circuits, which is critical during fault-finding or system upgrades. Some PLCs lack internal relays, so maintenance teams must account for this when designing control systems or troubleshooting equipment failures.</p>
          </div>
        </div>

        <!-- Key Learning Points moved to dedicated section below -->
      </div>
    </div>

    <!-- Key Takeaways Section -->
    <div class="worksheet-section key-takeaways-section">
      <h2 class="section-header"><i class="fas fa-list-check"></i> Key Takeaways</h2>
      <ul>
        <li>PLCs provide two main output types: low-current transistor outputs and high-current relay outputs.</li>
        <li>Transistor outputs are fast and ideal for signals to other control devices but have limited current capacity.</li>
        <li>Relay outputs are slower but robust, better suited for driving pumps, solenoids, and indicator beacons.</li>
        <li>External relays provide electrical isolation between control and power circuits for safety.</li>
        <li>Always check voltage and current ratings before connecting equipment to PLC outputs.</li>
        <li>Understanding output capabilities is essential for industrial maintenance and troubleshooting.</li>
      </ul>
    </div>

    <!-- Questions Section -->
    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-question-circle"></i> Questions</h2>
      <div class="questions-content">
        <div class="question-item" data-question="1">
          <h4>Question 1: What are the two main types of PLC outputs?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-1" value="A">
              <span class="option-text">A) Low-current transistor outputs and high-current relay outputs</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="B">
              <span class="option-text">B) Digital and analog outputs</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="C">
              <span class="option-text">C) AC and DC outputs</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="D">
              <span class="option-text">D) Input and output signals</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(1)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) Low-current transistor outputs and high-current relay outputs
          </div>
        </div>

        <div class="question-item" data-question="2">
          <h4>Question 2: What are transistor outputs best suited for?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-2" value="A">
              <span class="option-text">A) Driving high-power motors</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="B">
              <span class="option-text">B) Driving signals to other control devices</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="C">
              <span class="option-text">C) Operating heavy machinery</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="D">
              <span class="option-text">D) Powering indicator beacons</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(2)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) Driving signals to other control devices
          </div>
        </div>

        <div class="question-item" data-question="3">
          <h4>Question 3: Why are relay outputs preferred for driving loads like pumps and solenoids?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-3" value="A">
              <span class="option-text">A) They are faster than transistor outputs</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="B">
              <span class="option-text">B) They are more accurate</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="C">
              <span class="option-text">C) They are robust and can handle higher current</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="D">
              <span class="option-text">D) They consume less power</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(3)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) They are robust and can handle higher current
          </div>
        </div>

        <div class="question-item" data-question="4">
          <h4>Question 4: What is a key benefit of relays in control circuits?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-4" value="A">
              <span class="option-text">A) They increase signal speed</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="B">
              <span class="option-text">B) They provide electrical isolation between control and power circuits</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="C">
              <span class="option-text">C) They reduce system complexity</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="D">
              <span class="option-text">D) They eliminate the need for maintenance</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(4)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) They provide electrical isolation between control and power circuits
          </div>
        </div>

        <div class="question-item" data-question="5">
          <h4>Question 5: What should you always check before connecting equipment to PLC outputs?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-5" value="A">
              <span class="option-text">A) The color of the wires</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="B">
              <span class="option-text">B) The brand of the equipment</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="C">
              <span class="option-text">C) The voltage and current ratings</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="D">
              <span class="option-text">D) The installation date</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(5)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) The voltage and current ratings
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <div class="worksheet-bottom-nav">
    <div class="worksheet-header-content">
      <div class="worksheet-header-left">
        <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='CP6211-worksheets.html'">
          <i class="fas fa-arrow-left"></i>
          <span>Back to Worksheets</span>
        </button>
      </div>
      <div class="worksheet-header-center">
        <h1 class="worksheet-title">Worksheet 1 - Basic Outputs</h1>
      </div>
      <div class="worksheet-header-right">
        <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-2.html'">
          <span>Next Worksheet</span>
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>

<script>

// Enhanced answer handling functions
function submitAnswer(questionNumber) {
  const answerInput = document.querySelector(`[data-question="${questionNumber}"]`);
  if (!answerInput) return;
  
  const selectedOption = document.querySelector(`input[name="question-${questionNumber}"]:checked`);
  if (!selectedOption) {
    alert('Please select an answer before submitting.');
    return;
  }
  
  const answer = selectedOption.value;
  
  // Save with enhanced tracking if available
  if (typeof worksheetTracker !== 'undefined') {
    const worksheetId = getUrlParameter('id') || getWorksheetIdFromUrl();
    const path = window.location.pathname;
    const isFaultScenario = path.includes('fault-scenario');
    const type = getUrlParameter('type') || (isFaultScenario ? 'fault' : 'maintenance');
    worksheetTracker.saveAnswer(worksheetId, questionNumber, answer, type);
  } else {
    saveAnswer(questionNumber, answer);
  }
  
  // Get correct answer from the correct-answer div
  const correctAnswerDiv = answerInput.querySelector('.correct-answer');
  let correctAnswerText = '';
  if (correctAnswerDiv) {
    const strongElement = correctAnswerDiv.querySelector('strong');
    if (strongElement) {
      correctAnswerText = strongElement.nextSibling.textContent.trim();
    }
  }
  
  // Determine if answer is correct (extract letter from correct answer)
  const correctLetterMatch = correctAnswerText.match(/^([A-D])\)/);
  const correctLetter = correctLetterMatch ? correctLetterMatch[1] : null;
  const isCorrect = correctLetter && answer === correctLetter;
  
  // Style the selected option
  const allOptions = answerInput.querySelectorAll('.option-label');
  allOptions.forEach(option => {
    option.classList.remove('correct', 'incorrect');
  });
  
  if (isCorrect) {
    selectedOption.closest('.option-label').classList.add('correct');
  } else {
    selectedOption.closest('.option-label').classList.add('incorrect');
    // Also mark the correct option as correct
    const correctOption = answerInput.querySelector(`input[name="question-${questionNumber}"][value="${correctLetter}"]`);
    if (correctOption) {
      correctOption.closest('.option-label').classList.add('correct');
    }
  }
  
  const submitBtn = answerInput.querySelector('.submit-question-btn');
  if (submitBtn) {
    submitBtn.textContent = isCorrect ? 'Correct!' : 'Incorrect';
    submitBtn.style.background = isCorrect ? '#4CAF50' : '#f44336';
    setTimeout(() => {
      submitBtn.textContent = 'Submit Answer';
      submitBtn.style.background = '#4CAF50';
    }, 2000);
  }
  
  // Show correct answer
  if (correctAnswerDiv) {
    correctAnswerDiv.style.display = 'block';
  }
}


// Enhanced step tracking functions
function initializeStepTracking() {
  console.log('Initializing step tracking...');
  
  // Wait a bit to ensure DOM is ready
  setTimeout(() => {
    const stepCards = document.querySelectorAll('.step-card');
    console.log('Found', stepCards.length, 'step cards');
    
    stepCards.forEach((card, index) => {
      const checkbox = card.querySelector('.step-complete-checkbox');
      const stepNumber = card.getAttribute('data-step') || (index + 1);
      
      console.log('Setting up card', stepNumber, 'with checkbox:', !!checkbox);
      
      if (checkbox) {
        // Add a flag to prevent double execution
        let isProcessing = false;
        // Load saved state
        const savedState = localStorage.getItem(`step-${stepNumber}`);
        if (savedState === 'true') {
          checkbox.checked = true;
          card.classList.add('step-completed');
          // Apply the completed styles
          card.style.background = '#2a2a2a';
          card.style.opacity = '0.7';
          card.style.cursor = 'default';
        }
        
        // Make the entire card clickable
        card.style.cursor = 'pointer';
        card.style.position = 'relative';
        card.style.zIndex = '1';
        
                           // Add click handler to the entire card
          card.addEventListener('click', function(e) {
            console.log('Card clicked:', stepNumber);
            
            // Prevent double execution
            if (isProcessing) {
              console.log('Already processing, ignoring click');
              return;
            }
            
            // Don't toggle if clicking directly on the checkbox or its label
            if (e.target === checkbox || 
                e.target.closest('.step-checkbox') || 
                e.target.closest('label') ||
                e.target.tagName === 'INPUT' ||
                e.target.tagName === 'LABEL') {
              console.log('Clicking on checkbox or label, not toggling card');
              return;
            }
            
            // Prevent the default checkbox behavior and stop propagation
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            
            // Set processing flag
            isProcessing = true;
            
            // Toggle the checkbox directly without triggering events
            checkbox.checked = !checkbox.checked;
            
            // Manually call the change handler
            handleCheckboxChange(checkbox, card, stepNumber);
            
            console.log('Checkbox toggled to:', checkbox.checked);
            console.log('Card classes after toggle:', card.className);
            
            // Reset processing flag after a short delay
            setTimeout(() => {
              isProcessing = false;
            }, 100);
          });
        
                 // Create a shared change handler function
         function handleCheckboxChange(checkbox, card, stepNumber) {
           console.log('Checkbox changed:', stepNumber, 'checked:', checkbox.checked);
           
           if (checkbox.checked) {
             card.classList.add('step-completed');
             // Force the styles to apply
             card.style.background = '#2a2a2a';
             card.style.opacity = '0.7';
             card.style.cursor = 'default';
             console.log('Added step-completed class to card', stepNumber);
             console.log('Card classes after adding:', card.className);
             localStorage.setItem(`step-${stepNumber}`, 'true');
           } else {
             card.classList.remove('step-completed');
             // Reset the styles
             card.style.background = '';
             card.style.opacity = '';
             card.style.cursor = 'pointer';
             console.log('Removed step-completed class from card', stepNumber);
             console.log('Card classes after removing:', card.className);
             localStorage.setItem(`step-${stepNumber}`, 'false');
           }
         }
         
                   // Add change handler to checkbox
          checkbox.addEventListener('change', function() {
            if (!isProcessing) {
              handleCheckboxChange(checkbox, card, stepNumber);
            }
          });
        
                 // Also make the checkbox itself clickable
         checkbox.addEventListener('click', function(e) {
           e.stopPropagation(); // Prevent card click when clicking checkbox
           e.stopImmediatePropagation(); // Stop any other handlers
         });
      }
    });
  }, 100);
}

// Initialize when page loads
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeStepTracking);
} else {
  // DOM is already loaded
  initializeStepTracking();
}

// Also try again after a short delay to ensure everything is ready
setTimeout(initializeStepTracking, 500);


</script>
</body>
</html> 