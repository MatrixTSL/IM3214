<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Fault Detection & Troubleshooting</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">
  <script src="worksheet-core.js"></script>
  <script src="worksheet-tracking.js"></script>

  <style>
    /* System Overview */
    .system-overview {
      background: #1a1a1a;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .component-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-top: 15px;
    }

    .component-card {
      background: #23272b;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #333;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .component-icon {
      font-size: 24px;
      margin-bottom: 10px;
      transition: all 0.3s ease;
    }

    .component-name {
      font-weight: bold;
      margin-bottom: 5px;
      color: #aaa;
    }

    .component-status {
      font-size: 14px;
      margin-bottom: 10px;
    }

    .health-bar {
      width: 100%;
      height: 6px;
      background: #333;
      border-radius: 3px;
      overflow: hidden;
      margin-top: 10px;
    }

    .health-fill {
      height: 100%;
      transition: all 0.3s ease;
      border-radius: 3px;
    }

    /* Status Colors */
    .status-normal {
      color: #4CAF50;
    }

    .status-warning {
      color: #FFC107;
    }

    .status-fault {
      color: #FF5722;
    }

    .status-critical {
      color: #f44336;
    }

    /* Health Bar Colors */
    .health-normal { background: linear-gradient(to right, #388E3C, #4CAF50); }
    .health-warning { background: linear-gradient(to right, #FFA000, #FFC107); }
    .health-fault { background: linear-gradient(to right, #E64A19, #FF5722); }
    .health-critical { background: linear-gradient(to right, #D32F2F, #f44336); }

    /* Diagnostic Tools */
    .diagnostic-tools {
      background: #1a1a1a;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .tool-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-top: 15px;
    }

    .diagnostic-btn {
      background: #2196F3;
      color: white;
      border: none;
      padding: 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .diagnostic-btn:hover {
      background: #1976D2;
      box-shadow: 0 0 15px rgba(33,150,243,0.3);
    }

    .diagnostic-btn:disabled {
      background: #666;
      cursor: not-allowed;
    }

    /* Timer Section */
    .timer-section {
      background: #1a1a1a;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      text-align: center;
    }

    .timer-display {
      font-size: 48px;
      font-weight: bold;
      font-family: monospace;
      margin: 20px 0;
      color: #2196F3;
      text-shadow: 0 0 10px rgba(33,150,243,0.4);
    }

    .score-display {
      font-size: 24px;
      color: #4CAF50;
      margin-top: 10px;
    }

    /* Fault List */
    .fault-list {
      background: #23272b;
      padding: 15px;
      border-radius: 5px;
      margin-top: 10px;
    }

    .fault-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
      background: #1a1a1a;
      border-left: 3px solid;
    }

    .fault-item.critical { border-color: #f44336; }
    .fault-item.high { border-color: #FF5722; }
    .fault-item.medium { border-color: #FFC107; }
    .fault-item.low { border-color: #4CAF50; }

    .fault-name {
      flex: 1;
      font-weight: bold;
    }

    .fault-component {
      color: #666;
      font-style: italic;
    }

    .fault-severity {
      padding: 3px 8px;
      border-radius: 3px;
      font-size: 12px;
      text-transform: uppercase;
    }

    .fault-severity.critical { background: #f4433610; color: #f44336; }
    .fault-severity.high { background: #FF572210; color: #FF5722; }
    .fault-severity.medium { background: #FFC10710; color: #FFC107; }
    .fault-severity.low { background: #4CAF5010; color: #4CAF50; }

    /* Troubleshooting Steps */
    .step-list {
      display: grid;
      gap: 10px;
      margin-top: 15px;
    }

    .step-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 15px;
      background: #23272b;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .step-item:hover {
      background: #2a2f35;
    }

    .step-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }

    .step-item label {
      color: #aaa;
      cursor: pointer;
      flex: 1;
    }

    /* Diagnostic Log */
    .diagnostic-log {
      background: #23272b;
      padding: 15px;
      border-radius: 5px;
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      color: #aaa;
      margin-top: 10px;
    }

    .diagnostic-log p {
      margin: 5px 0;
      padding: 5px;
      border-radius: 3px;
      transition: background-color 0.3s ease;
    }

    .diagnostic-log p:hover {
      background: rgba(255,255,255,0.05);
    }

    .timestamp {
      color: #666;
      margin-right: 10px;
    }

    /* Animations */
    @keyframes healthPulse {
      0% { transform: scaleX(1); }
      50% { transform: scaleX(0.98); }
      100% { transform: scaleX(1); }
    }

    @keyframes statusBlink {
      0% { opacity: 1; }
      50% { opacity: 0.5; }
      100% { opacity: 1; }
    }

    @keyframes faultHighlight {
      0% { background: rgba(244,67,54,0.1); }
      50% { background: rgba(244,67,54,0.2); }
      100% { background: rgba(244,67,54,0.1); }
    }

    @keyframes timerWarning {
      0% { color: #2196F3; }
      50% { color: #FF5722; }
      100% { color: #2196F3; }
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="main-navigation">
    <div class="nav-container">
      <div class="nav-logo">
        <img src="assets/matrix-logo.png" alt="Matrix Logo">
      </div>
      <ul class="nav-menu" id="nav-menu">
        <li class="nav-item">
          <a href="#" onclick="window.location='index.html'" class="nav-link">
            <i class="fas fa-home"></i> HOME
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='CP2388-worksheets.html'" class="nav-link">
            <i class="fas fa-cogs"></i> CP2388
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='cp6773-worksheets.html'" class="nav-link">
            <i class="fas fa-exclamation-triangle"></i> CP6773
          </a>
        </li>
        
        <li class="nav-item">
          <a href="#" onclick="window.location='tracking-dashboard.html'" class="nav-link">
            <i class="fas fa-chart-line"></i> PROGRESS
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='about.html'" class="nav-link">
            <i class="fas fa-info-circle"></i> ABOUT
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-13.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Previous Worksheet</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Worksheet 14 - Fault Detection & Troubleshooting</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='index.html'">
            <span>Back to Home</span>
            <i class="fas fa-home"></i>
          </button>
        </div>
      </div>
    </div>
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> 1. Introduction</h2>
      <div class="worksheet-content">
        <div class="introduction-content-wrapper">
          <div class="introduction-text">
            <p>This worksheet covers comprehensive fault detection and troubleshooting procedures for closed-loop control systems. Learn systematic approaches to identify, diagnose, and resolve faults in industrial systems using advanced diagnostic techniques and root cause analysis.</p>
          </div>
          <div class="introduction-image">
            <div class="system-diagram">
              <img src="assets/maintenance/faults.png" alt="Fault Detection & Troubleshooting">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Over To You Section -->
    <div class="worksheet-section over-to-you-section">
      <h2 class="section-header"><i class="fas fa-hands-helping"></i> 2. Over To You</h2>
      <div class="worksheet-content">
        <div class="steps-container">
          <div class="step-card" data-step="1">
            <div class="step-number">1</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Run the System and Trigger E-Stop</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Run the system and then hit the E-Stop.</p>
            </div>
          </div>
          <div class="step-card" data-step="2">
            <div class="step-number">2</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Check Alarms Page</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Before clearing the fault, close the popup and navigate to the <strong>Alarms</strong> page on the HMI.<br>
              This is a common way of displaying alarms, in a tabular format, with date and time.</p>
            </div>
          </div>
          <div class="step-card" data-step="3">
            <div class="step-number">3</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Check Alarm Raise Time</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Check the raise time of the alarm. This is the time the alarm occurred. Checking this time when an alarm occurs is important.</p>
            </div>
          </div>
          <div class="step-card" data-step="4">
            <div class="step-number">4</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Check Fault Page</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Navigate back to the Main Menu and then to the <strong>Fault Page</strong> on the HMI.<br>
              This is a page similar to the IO page, where it displays all the faults that occur in the software.<br>
              It shows the status of each fault, active or inactive.</p>
            </div>
          </div>
          <div class="step-card" data-step="5">
            <div class="step-number">5</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Test Other Faults</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Reset the Emergency Stop and try another fault, like the proximity switch or temperature offset.<br>
              Navigate to the Faults and Alarms pages and view the new fault.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- So What Section -->
    <div class="worksheet-section so-what-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> 3. So What?</h2>
      <div class="so-what-content">
        <!-- Fault Finding Overview Card -->
        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>Fault Finding System Overview</h3>
          </div>
          <div class="card-content">
            <p>To become proficient in fault finding, you must develop an understanding of system behaviours and learn to recognize abnormal conditions.</p>
          </div>
        </div>

        <!-- Fault Types Card -->
        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-cogs"></i>
            <h3>Types of Industrial Faults</h3>
          </div>
          <div class="card-content">
            <div class="key-points-grid">
              <div class="key-point-item">
                <div class="key-point-icon">
                  <i class="fas fa-code"></i>
                </div>
                <div class="key-point-content">
                  <strong>Software Faults</strong>
                  <p>These occur due to incorrect programming or parameter settings that cause the system to behave unpredictably. For example, a temperature offset in software can prevent the system from starting.</p>
                </div>
              </div>
              
              <div class="key-point-item">
                <div class="key-point-icon">
                  <i class="fas fa-bolt"></i>
                </div>
                <div class="key-point-content">
                  <strong>Electrical Faults</strong>
                  <p>These arise from issues such as broken connections, faulty wiring, or sensor failures, leading to incorrect readings or system shutdowns.</p>
                </div>
              </div>
              
              <div class="key-point-item">
                <div class="key-point-icon">
                  <i class="fas fa-cogs"></i>
                </div>
                <div class="key-point-content">
                  <strong>Mechanical Faults</strong>
                  <p>These involve physical issues like stuck valves or damaged components, affecting the movement of fluids or mechanical parts.</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Key Learning Points Card -->
        <div class="key-points-card">
          <div class="card-header">
            <i class="fas fa-lightbulb"></i>
            <h3>Key Learning Points</h3>
          </div>
          <div class="key-points-grid">
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-tools"></i>
              </div>
              <div class="key-point-content">
                <strong>Fault finding is a critical skill in industrial maintenance, used to identify and fix mechanical, electrical, and software issues.</strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-search"></i>
              </div>
              <div class="key-point-content">
                <strong>Industrial faults are either software (settings or code issues), electrical (wiring or sensor faults), or mechanical (stuck or damaged parts).</strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-desktop"></i>
              </div>
              <div class="key-point-content">
                <strong>Alarms and fault screens on the HMI help diagnose issues by showing when and where a fault occurred.</strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-clock"></i>
              </div>
              <div class="key-point-content">
                <strong>Checking the alarm raise time can help trace when a problem started.</strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-chart-line"></i>
              </div>
              <div class="key-point-content">
                <strong>Recognising patterns and abnormal behaviour in the system is key to diagnosing faults effectively.</strong>
              </div>
            </div>
            
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-graduation-cap"></i>
              </div>
              <div class="key-point-content">
                <strong>Practising with simulated faults, such as E-stops or sensor offsets, helps build confidence in real-world troubleshooting.</strong>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-question-circle"></i> Questions & Answers</h2>
      <div class="questions-content">
        <div class="question-item" data-question="1">
          <h4>Question 1: Why is fault finding important in industrial maintenance?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-1" value="A" class="option-radio">
              <span class="option-text">A) It helps identify and fix issues that could stop the system from running safely and efficiently</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="B" class="option-radio">
              <span class="option-text">B) It is only required for new systems</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="C" class="option-radio">
              <span class="option-text">C) It is mainly for reducing paperwork</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="D" class="option-radio">
              <span class="option-text">D) It is only done after a breakdown</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(1)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) It helps identify and fix issues that could stop the system from running safely and efficiently.
          </div>
        </div>
        <div class="question-item" data-question="2">
          <h4>Question 2: What are the three main types of faults in industrial systems?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-2" value="A" class="option-radio">
              <span class="option-text">A) Software faults, electrical faults, and mechanical faults</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="B" class="option-radio">
              <span class="option-text">B) Hydraulic faults, pneumatic faults, and optical faults</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="C" class="option-radio">
              <span class="option-text">C) Operator faults, design faults, and environmental faults</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="D" class="option-radio">
              <span class="option-text">D) Sensor faults, actuator faults, and network faults</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(2)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) Hydraulic faults, pneumatic faults, and optical faults.
          </div>
        </div>
        <div class="question-item" data-question="3">
          <h4>Question 3: How does the HMI help with diagnosing faults?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-3" value="A" class="option-radio">
              <span class="option-text">A) The HMI shows alarms and fault status, helping to locate and understand the issue</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="B" class="option-radio">
              <span class="option-text">B) The HMI only displays system graphics</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="C" class="option-radio">
              <span class="option-text">C) The HMI is not used for fault diagnosis</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="D" class="option-radio">
              <span class="option-text">D) The HMI only logs user actions</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(3)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) The HMI is not used for fault diagnosis.
          </div>
        </div>
        <div class="question-item" data-question="4">
          <h4>Question 4: What is the purpose of checking the alarm raise time on the HMI?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-4" value="A" class="option-radio">
              <span class="option-text">A) It shows exactly when the fault happened, helping to trace the cause</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="B" class="option-radio">
              <span class="option-text">B) It is only for record keeping</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="C" class="option-radio">
              <span class="option-text">C) It is used to reset the system</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="D" class="option-radio">
              <span class="option-text">D) It is not important for troubleshooting</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(4)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> D) It is not important for troubleshooting.
          </div>
        </div>
        <div class="question-item" data-question="5">
          <h4>Question 5: How can practising with simulated faults improve troubleshooting skills?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-5" value="A" class="option-radio">
              <span class="option-text">A) It builds confidence and teaches how to spot and respond to problems in a real system</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="B" class="option-radio">
              <span class="option-text">B) It is only for entertainment</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="C" class="option-radio">
              <span class="option-text">C) It is not useful for real-world skills</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="D" class="option-radio">
              <span class="option-text">D) It is only for advanced users</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(5)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) It helps identify and fix issues that could stop the system from running safely and efficiently.
          </div>
        </div>
      </div>
    </div>

    <!-- Simulation Section -->
    <div class="simulation-section">
      <h2 class="section-header"><i class="fas fa-cogs"></i> 3. Interactive Fault Detection & Troubleshooting</h2>
      <div id="fault-detection-panel" class="simulation-container">
        <div class="simulation-loading">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading fault detection simulation...</p>
          <p>Simulation will initialize automatically</p>
        </div>
      </div>
    </div>
  </div>



  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="fault-detection-simulation.js"></script>
  
  <script>
    // Define correct answers for worksheet 14
    const correctAnswers = {
      "1": "B",
      "2": "B",
      "3": "C",
      "4": "D",
      "5": "B"
    };

    function submitAnswer(questionNumber) {
      const questionItem = document.querySelector(`[data-question="${questionNumber}"]`);
      if (!questionItem) return;
      
      const selectedOption = questionItem.querySelector('.option-radio:checked');
      if (!selectedOption) {
        alert('Please select an answer before submitting.');
        return;
      }
      
      const answer = selectedOption.value;
      
      // Save with enhanced tracking
      worksheetTracker.saveAnswer(14, questionNumber, answer, 'maintenance');
      
      // Apply visual feedback
      const allOptions = questionItem.querySelectorAll('.option-label');
      const correctAnswer = correctAnswers[questionNumber];
      
      allOptions.forEach(option => {
        const radio = option.querySelector('.option-radio');
        const optionValue = radio.value;
        
        if (optionValue === correctAnswer) {
          option.classList.add('correct');
        } else if (optionValue === answer && answer !== correctAnswer) {
          option.classList.add('incorrect');
        }
      });
      
      // Mark question as submitted to disable further interaction
      questionItem.classList.add('submitted');
      
      // Update submit button
      const button = questionItem.querySelector('.submit-question-btn');
      const originalText = button.textContent;
      button.textContent = answer === correctAnswer ? 'Correct!' : 'Incorrect!';
      button.style.background = answer === correctAnswer ? '#4CAF50' : '#f44336';
      
      // Add incorrect class for enhanced styling
      if (answer !== correctAnswer) {
        button.classList.add('incorrect');
      }
      
      setTimeout(() => {
        button.textContent = originalText;
        button.style.background = '#4CAF50';
        button.classList.remove('incorrect');
      }, 2000);

      // Show correct answer
      const correctAnswerDiv = questionItem.querySelector('.correct-answer');
      if (correctAnswerDiv) {
        correctAnswerDiv.style.display = 'block';
      }
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize tracking system
      if (typeof worksheetTracker === 'undefined') {
        console.error('Worksheet tracking system not loaded');
        return;
      }

      // Load any saved answers
      const progress = worksheetTracker.getWorksheetProgress(14, 'maintenance');
      if (progress && progress.answers) {
        Object.entries(progress.answers).forEach(([questionNumber, answerData]) => {
          const questionItem = document.querySelector(`[data-question="${questionNumber}"]`);
          if (questionItem) {
            const radio = questionItem.querySelector(`.option-radio[value="${answerData.value}"]`);
            if (radio) {
              radio.checked = true;
              // Show the correct answer for previously answered questions
              const correctAnswerDiv = questionItem.querySelector('.correct-answer');
              if (correctAnswerDiv) {
                correctAnswerDiv.style.display = 'block';
              }
            }
          }
        });
      }
    });
    
    // Step card click functionality
    function initializeStepCardClicks() {
      const stepCards = document.querySelectorAll('.step-card');
      
      stepCards.forEach(card => {
        card.addEventListener('click', function(e) {
          // Don't trigger if clicking on the checkbox itself
          if (e.target.closest('.step-checkbox')) {
            return;
          }
          
          const checkbox = this.querySelector('.step-complete-checkbox');
          if (checkbox) {
            // Toggle the checkbox
            checkbox.checked = !checkbox.checked;
            
            // Update the card's completed state using the existing class name
            if (checkbox.checked) {
              this.classList.add('step-completed');
            } else {
              this.classList.remove('step-completed');
            }
            
            // Trigger change event on checkbox for any existing listeners
            const event = new Event('change', { bubbles: true });
            checkbox.dispatchEvent(event);
          }
        });
      });
    }
    
    // Initialize step card functionality when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      initializeStepCardClicks();
      
      // Use the existing step tracking system
      if (typeof initializeStepTracking === 'function') {
        initializeStepTracking();
      }
    });
  </script>
  
  <!-- Bottom Navigation -->
  <div class="worksheet-bottom-nav">
    <div class="worksheet-header-content">
      <div class="worksheet-header-left">
        <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-13.html'">
          <i class="fas fa-arrow-left"></i>
          <span>Previous Worksheet</span>
        </button>
      </div>
      <div class="worksheet-header-center">
        <h1 class="worksheet-title">Worksheet 14 - Fault Detection & Troubleshooting</h1>
      </div>
      <div class="worksheet-header-right">
        <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='index.html'">
          <span>Back to Home</span>
          <i class="fas fa-home"></i>
        </button>
      </div>
    </div>
  </div>
  
</body>
</html> 