<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Emergency Stops</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">
  <link rel="manifest" href="manifest.json">
  <script src="worksheet-core.js"></script>
  <script src="worksheet-tracking.js"></script>
  <script defer src="shared-navigation.js"></script>
  <script defer src="pwa-install.js"></script>

</head>
<body>


  <!-- Main Content -->
  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-3.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Previous Worksheet</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Worksheet 4 - Emergency Stops</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-5.html'">
            <span>Next Worksheet</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
    <!-- Introduction Section -->
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> 1. Introduction</h2>
      <div class="worksheet-content">
        <div class="introduction-content-wrapper">
          <div class="introduction-text">
            <p>An Emergency Stop (E-Stop) is a safety button that quickly stops a machine or system when there is an emergency. It helps keep people safe and prevents damage to equipment. An E-Stop is not the same as a normal stop button. It should only be used in emergencies, not to turn off the machine during normal use.</p>
          </div>
          <div class="introduction-image">
            <div class="system-diagram">
              <img src="assets/maintenance/plc.png" alt="PLC System Maintenance">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Over To You Section -->
    <div class="worksheet-section over-to-you-section">
      <h2 class="section-header"><i class="fas fa-hands-helping"></i> 2. Over To You</h2>
      <div class="worksheet-content">
        <p><strong>Follow these steps to work with the Emergency Stop:</strong></p>

        <div class="steps-container">
          <div class="step-card" data-step="1">
            <div class="step-number">1</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Open Worksheet 4</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Navigate to Worksheet 4 on the HMI. This is the same system as Worksheet 3, with fewer items on screen so you can focus on the E-Stop.</p>
            </div>
          </div>

          <div class="step-card" data-step="2">
            <div class="step-number">2</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Find the E-Stop</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Locate the Emergency Stop button at the top of your training rig.</p>
            </div>
          </div>

          <div class="step-card" data-step="3">
            <div class="step-number">3</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Start and Stop</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Start the mix. When the tank is about half full, press the E-Stop.</p>
            </div>
          </div>

          <div class="step-card" data-step="4">
            <div class="step-number">4</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Alarm Banner</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Read the alarm banner at the bottom of the screen. Tap it to go to the Alarm page and find the E-Stop alarm in the table.</p>
            </div>
          </div>

          <div class="step-card" data-step="5">
            <div class="step-number">5</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Reset Procedure</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Twist the E-Stop left to reset it, then press the blue reset button. Confirm that the E-Stop alarm is cleared.</p>
            </div>
          </div>

          <div class="step-card" data-step="6">
            <div class="step-number">6</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Check Faults Page</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Go back to Main Menu → Faults page. Confirm the E-Stop fault is cleared.</p>
            </div>
          </div>

          <div class="step-card" data-step="7">
            <div class="step-number">7</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Repeat and Reset on HMI</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Press the E-Stop again and observe the fault on the Faults page. This time, reset the system using the Reset button on the HMI.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- So What Section -->
    <div class="worksheet-section so-what-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> 3. So What?</h2>
      <div class="so-what-content">
        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-cogs"></i>
            <h3>Why this matters</h3>
          </div>
          <div class="card-content">
            <p>E-Stops have dual channels or two inputs into the control system, to make them reliable and safe. After using an E-Stop, the emergency stop button must be reset and the reset button must be pressed once before the system can start again. Regularly inspect the E-Stop for damage or loose parts and test it during downtime to ensure it functions properly. Never cover or tamper with one.</p>
          </div>
        </div>

        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-shield-halved"></i>
            <h3>How it protects people</h3>
          </div>
          <div class="card-content">
            <p>The E‑Stop removes power to motion and brings the machine to a safe state. Two channels mean a single wiring fault won’t defeat the safety function. A manual reset prevents unexpected restart.</p>
          </div>
        </div>

        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-screwdriver-wrench"></i>
            <h3>Maintenance tips</h3>
          </div>
          <div class="card-content">
            <p>Check the button latches and releases cleanly, terminals are tight, and inputs change on the PLC/HMI when pressed. Test during planned downtime and record results.</p>
          </div>
        </div>
      </div>

    </div>

    <!-- Key Takeaways Section -->
    <div class="worksheet-section key-takeaways-section">
      <h2 class="section-header"><i class="fas fa-list-check"></i> Key Takeaways</h2>
      <ul>
        <li>E-Stops are for emergencies, not regular use.</li>
        <li>They have two safety circuits to make sure they work.</li>
        <li>Manual reset is required before restart.</li>
        <li>Regular checks and tests keep them reliable.</li>
      </ul>
    </div>

    <!-- Questions Section -->
    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-question-circle"></i> Questions & Answers</h2>
      <div class="questions-content">
        <div class="question-item" data-question="1">
          <h4>Question 1: What is a PLC and what is it designed for?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-1" value="A" class="option-radio">
              <span class="option-text">A) A Programmable Logic Controller (PLC) is an industrial computer designed for real-time control of machines and processes in harsh environments</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="B" class="option-radio">
              <span class="option-text">B) A Personal Logic Computer designed for office use</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="C" class="option-radio">
              <span class="option-text">C) A Portable Light Controller for lighting systems</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="D" class="option-radio">
              <span class="option-text">D) A Power Level Controller for electrical systems</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(1)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) A Portable Light Controller for lighting systems.
          </div>
        </div>
        
        <div class="question-item" data-question="2">
          <h4>Question 2: What do the status LEDs on the PLC indicate?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-2" value="A" class="option-radio">
              <span class="option-text">A) They show real-time feedback of input and output signals, helping verify if components are functioning correctly</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="B" class="option-radio">
              <span class="option-text">B) They show the temperature of the PLC</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="C" class="option-radio">
              <span class="option-text">C) They show the power consumption of the system</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="D" class="option-radio">
              <span class="option-text">D) They show the time of day</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(2)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) They show the temperature of the PLC.
          </div>
        </div>
        
        <div class="question-item" data-question="3">
          <h4>Question 3: What does it mean if an input LED expected to be on is not lit?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-3" value="A" class="option-radio">
              <span class="option-text">A) It could indicate a faulty sensor, wiring problem, or failed connection</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="B" class="option-radio">
              <span class="option-text">B) It means the PLC is working normally</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="C" class="option-radio">
              <span class="option-text">C) It means the system is in standby mode</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="D" class="option-radio">
              <span class="option-text">D) It means the LED is broken</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(3)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> D) It means the LED is broken.
          </div>
        </div>
        
        <div class="question-item" data-question="4">
          <h4>Question 4: What should you observe on the output LEDs when the system starts?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-4" value="A" class="option-radio">
              <span class="option-text">A) One of the output LEDs will flash briefly, this represents the system's status LED</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="B" class="option-radio">
              <span class="option-text">B) All output LEDs should turn off</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="C" class="option-radio">
              <span class="option-text">C) All output LEDs should stay on continuously</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="D" class="option-radio">
              <span class="option-text">D) The output LEDs should change color</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(4)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) One of the output LEDs will flash briefly, this represents the system's status LED.
          </div>
        </div>
        
        <div class="question-item" data-question="5">
          <h4>Question 5: How can you tell the flow sensor is working by looking at the PLC?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-5" value="A" class="option-radio">
              <span class="option-text">A) One of the input LEDs will flash rapidly; if flow is reduced, it slows down, and if flow increases, it nearly goes solid, showing the sensor is active</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="B" class="option-radio">
              <span class="option-text">B) The input LED should stay off completely</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="C" class="option-radio">
              <span class="option-text">C) The input LED should stay on continuously</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="D" class="option-radio">
              <span class="option-text">D) The input LED should change color</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(5)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) The input LED should stay off completely.
          </div>
        </div>
      </div>
    </div>

    <!-- Diagnostic Challenge Section -->
    <div class="simulation-section">
      <h2 class="section-header"><i class="fas fa-search"></i> 3. System State Diagnostic Challenge</h2>
      <div class="worksheet-content">
        <p><strong>Analyze the following system states and identify what each condition represents. Use the PLC I/O display above to help you understand the system behavior.</strong></p>
        
        <div class="diagnostic-scenarios">
          <!-- Scenario 1 -->
          <div class="scenario-card" style="background: #2a2a2a; border-radius: 12px; padding: 25px; margin-bottom: 25px; border-left: 4px solid #FF9800;">
            <div class="scenario-header" style="margin-bottom: 20px;">
              <h3 style="color: #FF9800; margin: 0; font-size: 18px;">
                <i class="fas fa-exclamation-triangle"></i> Scenario 1
              </h3>
            </div>
            
            <!-- Scenario 1 I/O Display -->
            <div class="scenario-io-display" style="background: #1a1a1a; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
              <h4 style="color: #2196F3; margin-bottom: 15px; font-size: 16px; display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-microchip"></i> PLC I/O Status - Scenario 1
              </h4>
              
              <div class="io-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <!-- Digital Inputs -->
                <div class="digital-inputs">
                  <h5 style="color: #4CAF50; margin-bottom: 12px; font-size: 14px;">
                    <i class="fas fa-sign-in-alt"></i> Digital Inputs
                  </h5>
                  <div style="display: grid; gap: 8px;">
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #4CAF50;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Estop Channel 1</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">E-Stop Ch1 [NC]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_0</div>
                        <div style="color: #4CAF50; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">CLOSED</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #4CAF50;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Estop Channel 2</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">E-Stop Ch2 [NC]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_1</div>
                        <div style="color: #4CAF50; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">CLOSED</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #666;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Reset Button</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #333; border: 2px solid #555;"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">System Reset [NO]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_2</div>
                        <div style="color: #666; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">INACTIVE</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #4CAF50;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank High Float Switch</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">High Level [NC]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_3</div>
                        <div style="color: #4CAF50; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">CLOSED</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #666;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank Low Float Switch</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #333; border: 2px solid #555;"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">Low Level [NO]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_4</div>
                        <div style="color: #666; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">INACTIVE</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #666;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank Cover Switch</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #333; border: 2px solid #555;"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">Cover Position [NO]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_5</div>
                        <div style="color: #666; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">INACTIVE</div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Analogue Values -->
                <div class="analogue-values">
                  <h5 style="color: #9C27B0; margin-bottom: 12px; font-size: 14px;">
                    <i class="fas fa-chart-line"></i> Analogue Values
                  </h5>
                  <div style="display: grid; gap: 8px;">
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank Temperature</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">45°C</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Tank Temperature Sensor</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_0</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-100°C</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 45%;"></div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Flow Rate</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">0l/h</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Flow Rate Measurement</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_1</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-500l/h</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 0%;"></div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Pump Demand</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">100%</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Pump Speed Demand</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_2</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-100%</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 100%;"></div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Valve Demand</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">0%</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Valve Position Demand</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_3</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-100%</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 0%;"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="question-item" data-question="scenario-1">
              <h4>What does this system state indicate?</h4>
              <div class="multiple-choice-options">
                <label class="option-label">
                  <input type="radio" name="scenario-1" value="A" class="option-radio">
                  <span class="option-text">A) Pump is running at full speed but valve is closed, preventing flow - likely a control system issue</span>
                </label>
                <label class="option-label">
                  <input type="radio" name="scenario-1" value="B" class="option-radio">
                  <span class="option-text">B) Normal operation - system is starting up</span>
                </label>
                <label class="option-label">
                  <input type="radio" name="scenario-1" value="C" class="option-radio">
                  <span class="option-text">C) Emergency stop is activated</span>
                </label>
                <label class="option-label">
                  <input type="radio" name="scenario-1" value="D" class="option-radio">
                  <span class="option-text">D) Low tank level causing pump cavitation</span>
                </label>
              </div>
              <div class="question-actions">
                <button class="submit-question-btn" onclick="submitScenarioAnswer('scenario-1')">Submit Answer</button>
              </div>
              <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
                <strong style="color: #4CAF50;">Correct Answer:</strong> A) Pump is running at full speed but valve is closed, preventing flow - likely a control system issue or valve malfunction.
              </div>
            </div>
          </div>

          <!-- Scenario 2 -->
          <div class="scenario-card" style="background: #2a2a2a; border-radius: 12px; padding: 25px; margin-bottom: 25px; border-left: 4px solid #F44336;">
            <div class="scenario-header" style="margin-bottom: 20px;">
              <h3 style="color: #F44336; margin: 0; font-size: 18px;">
                <i class="fas fa-times-circle"></i> Scenario 2
              </h3>
            </div>
            
            <!-- Scenario 2 I/O Display -->
            <div class="scenario-io-display" style="background: #1a1a1a; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
              <h4 style="color: #2196F3; margin-bottom: 15px; font-size: 16px; display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-microchip"></i> PLC I/O Status - Scenario 2
              </h4>
              
              <div class="io-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <!-- Digital Inputs -->
                <div class="digital-inputs">
                  <h5 style="color: #4CAF50; margin-bottom: 12px; font-size: 14px;">
                    <i class="fas fa-sign-in-alt"></i> Digital Inputs
                  </h5>
                  <div style="display: grid; gap: 8px;">
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #4CAF50;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Estop Channel 1</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">E-Stop Ch1 [NC]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_0</div>
                        <div style="color: #4CAF50; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">CLOSED</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #4CAF50;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Estop Channel 2</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">E-Stop Ch2 [NC]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_1</div>
                        <div style="color: #4CAF50; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">CLOSED</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #666;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Reset Button</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #333; border: 2px solid #555;"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">System Reset [NO]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_2</div>
                        <div style="color: #666; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">INACTIVE</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #4CAF50;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank High Float Switch</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">High Level [NC]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_3</div>
                        <div style="color: #4CAF50; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">CLOSED</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #666;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank Low Float Switch</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #333; border: 2px solid #555;"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">Low Level [NO]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_4</div>
                        <div style="color: #666; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">INACTIVE</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #666;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank Cover Switch</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #333; border: 2px solid #555;"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">Cover Position [NO]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_5</div>
                        <div style="color: #666; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">INACTIVE</div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Analogue Values -->
                <div class="analogue-values">
                  <h5 style="color: #9C27B0; margin-bottom: 12px; font-size: 14px;">
                    <i class="fas fa-chart-line"></i> Analogue Values
                  </h5>
                  <div style="display: grid; gap: 8px;">
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank Temperature</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">25°C</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Tank Temperature Sensor</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_0</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-100°C</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 25%;"></div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Flow Rate</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">0l/h</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Flow Rate Measurement</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_1</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-500l/h</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 0%;"></div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Pump Demand</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">100%</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Pump Speed Demand</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_2</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-100%</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 100%;"></div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Valve Demand</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">100%</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Valve Position Demand</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_3</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-100%</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 100%;"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="question-item" data-question="scenario-2">
              <h4>What does this system state indicate?</h4>
              <div class="multiple-choice-options">
                <label class="option-label">
                  <input type="radio" name="scenario-2" value="A" class="option-radio">
                  <span class="option-text">A) System is operating normally at low demand</span>
                </label>
                <label class="option-label">
                  <input type="radio" name="scenario-2" value="B" class="option-radio">
                  <span class="option-text">B) Critical system fault - pump and valve fully active but no flow detected, likely pump failure or blockage</span>
                </label>
                <label class="option-label">
                  <input type="radio" name="scenario-2" value="C" class="option-radio">
                  <span class="option-text">C) Valve is stuck closed</span>
                </label>
                <label class="option-label">
                  <input type="radio" name="scenario-2" value="D" class="option-radio">
                  <span class="option-text">D) Flow sensor calibration error</span>
                </label>
              </div>
              <div class="question-actions">
                <button class="submit-question-btn" onclick="submitScenarioAnswer('scenario-2')">Submit Answer</button>
              </div>
              <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
                <strong style="color: #4CAF50;">Correct Answer:</strong> B) Critical system fault - pump and valve fully active but no flow detected, indicating pump failure, blockage, or empty tank.
              </div>
            </div>
          </div>

          <!-- Scenario 3 -->
          <div class="scenario-card" style="background: #2a2a2a; border-radius: 12px; padding: 25px; margin-bottom: 25px; border-left: 4px solid #9C27B0;">
            <div class="scenario-header" style="margin-bottom: 20px;">
              <h3 style="color: #9C27B0; margin: 0; font-size: 18px;">
                <i class="fas fa-water"></i> Scenario 3
              </h3>
            </div>
            
            <!-- Scenario 3 I/O Display -->
            <div class="scenario-io-display" style="background: #1a1a1a; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
              <h4 style="color: #2196F3; margin-bottom: 15px; font-size: 16px; display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-microchip"></i> PLC I/O Status - Scenario 3
              </h4>
              
              <div class="io-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <!-- Digital Inputs -->
                <div class="digital-inputs">
                  <h5 style="color: #4CAF50; margin-bottom: 12px; font-size: 14px;">
                    <i class="fas fa-sign-in-alt"></i> Digital Inputs
                  </h5>
                  <div style="display: grid; gap: 8px;">
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #4CAF50;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Estop Channel 1</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">E-Stop Ch1 [NC]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_0</div>
                        <div style="color: #4CAF50; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">CLOSED</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #4CAF50;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Estop Channel 2</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">E-Stop Ch2 [NC]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_1</div>
                        <div style="color: #4CAF50; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">CLOSED</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #666;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Reset Button</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #333; border: 2px solid #555;"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">System Reset [NO]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_2</div>
                        <div style="color: #666; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">INACTIVE</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #666;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank High Float Switch</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #333; border: 2px solid #555;"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">High Level [NC]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_3</div>
                        <div style="color: #666; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">OPEN</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #4CAF50;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank Low Float Switch</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">Low Level [NO]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_4</div>
                        <div style="color: #4CAF50; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">ACTIVE</div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #666;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank Cover Switch</span>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #333; border: 2px solid #555;"></div>
                      </div>
                      <div style="color: #AAA; font-size: 10px;">Cover Position [NO]</div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #888; font-size: 9px;">DI_5</div>
                        <div style="color: #666; font-size: 9px; font-weight: bold; background: #222; padding: 1px 4px; border-radius: 2px;">INACTIVE</div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Analogue Values -->
                <div class="analogue-values">
                  <h5 style="color: #9C27B0; margin-bottom: 12px; font-size: 14px;">
                    <i class="fas fa-chart-line"></i> Analogue Values
                  </h5>
                  <div style="display: grid; gap: 8px;">
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Tank Temperature</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">35°C</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Tank Temperature Sensor</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_0</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-100°C</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 35%;"></div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Flow Rate</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">180l/h</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Flow Rate Measurement</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_1</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-500l/h</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 36%;"></div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Pump Demand</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">0%</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Pump Speed Demand</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_2</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-100%</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 0%;"></div>
                      </div>
                    </div>
                    <div style="background: #333; padding: 12px; border-radius: 6px; border-left: 4px solid #9C27B0;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <span style="color: #FFFFFF; font-size: 12px; font-weight: bold;">Valve Demand</span>
                        <span style="color: #9C27B0; font-size: 14px; font-weight: bold; background: #222; padding: 3px 6px; border-radius: 3px;">75%</span>
                      </div>
                      <div style="color: #AAA; font-size: 10px; margin-bottom: 6px;">Valve Position Demand</div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <div style="color: #888; font-size: 9px;">AI_3</div>
                        <div style="color: #666; font-size: 8px;">Range: 0-100%</div>
                      </div>
                      <div style="background: #222; border-radius: 2px; overflow: hidden; height: 4px;">
                        <div style="background: linear-gradient(90deg, #9C27B0, #BA68C8); height: 100%; width: 75%;"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="question-item" data-question="scenario-3">
              <h4>What does this system state indicate?</h4>
              <div class="multiple-choice-options">
                <label class="option-label">
                  <input type="radio" name="scenario-3" value="A" class="option-radio">
                  <span class="option-text">A) Pump malfunction - not responding to control signals</span>
                </label>
                <label class="option-label">
                  <input type="radio" name="scenario-3" value="B" class="option-radio">
                  <span class="option-text">B) Tank overfull condition - pump stopped, valve partially open for controlled drainage</span>
                </label>
                <label class="option-label">
                  <input type="radio" name="scenario-3" value="C" class="option-radio">
                  <span class="option-text">C) System in energy-saving mode</span>
                </label>
                <label class="option-label">
                  <input type="radio" name="scenario-3" value="D" class="option-radio">
                  <span class="option-text">D) Normal low-demand operation</span>
                </label>
              </div>
              <div class="question-actions">
                <button class="submit-question-btn" onclick="submitScenarioAnswer('scenario-3')">Submit Answer</button>
              </div>
              <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
                <strong style="color: #4CAF50;">Correct Answer:</strong> B) Tank overfull condition - pump stopped due to high level float switch, valve partially open for controlled drainage.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>



  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      loadSavedAnswers();
    });
    
        function submitAnswer(questionNumber) {
          const answerInput = document.querySelector(`[data-question="${questionNumber}"]`);
          if (!answerInput) return;
          
          const selectedOption = document.querySelector(`input[name="question-${questionNumber}"]:checked`);
          if (!selectedOption) {
            alert('Please select an answer before submitting.');
            return;
          }
          
          const answer = selectedOption.value;
          
          // Save with enhanced tracking
          worksheetTracker.saveAnswer(4, questionNumber, answer, 'maintenance');
          
          // Define correct answers for worksheet 4
          const correctAnswers = {
                "1": "C",
                "2": "B",
                "3": "D",
                "4": "A",
                "5": "B",
                "scenario-1": "A",
                "scenario-2": "B", 
                "scenario-3": "B"
          };
          
          // Apply visual feedback
          const allOptions = answerInput.querySelectorAll('.option-label');
          const correctAnswer = correctAnswers[questionNumber];
          
          allOptions.forEach(option => {
            const radio = option.querySelector('.option-radio');
            const optionValue = radio.value;
            
            if (optionValue === correctAnswer) {
              option.classList.add('correct');
            } else if (optionValue === answer && answer !== correctAnswer) {
              option.classList.add('incorrect');
            }
          });
          
          // Mark question as submitted to disable further interaction
          answerInput.classList.add('submitted');
          
          // Show feedback on button
          const submitBtn = answerInput.querySelector('.submit-question-btn');
          if (submitBtn) {
            const originalText = submitBtn.textContent;
            submitBtn.textContent = answer === correctAnswer ? 'Correct!' : 'Incorrect!';
            submitBtn.style.background = answer === correctAnswer ? '#4CAF50' : '#f44336';
            
            // Add incorrect class for enhanced styling
            if (answer !== correctAnswer) {
              submitBtn.classList.add('incorrect');
            }
            
            setTimeout(() => {
              submitBtn.textContent = originalText;
              submitBtn.style.background = '#4CAF50';
              submitBtn.classList.remove('incorrect');
            }, 2000);
          }
          
          // Show correct answer if available
          const correctAnswerDiv = answerInput.querySelector('.correct-answer');
          if (correctAnswerDiv) {
            correctAnswerDiv.style.display = 'block';
          }
        }

    // Scenario Challenge Functions
    let scenarioAnswers = {};
    
    // Define correct answers for scenarios
    const correctAnswers = {
      "scenario-1": "A",  // Pump deadhead condition
      "scenario-2": "B",  // Critical system fault
      "scenario-3": "B"   // Tank overfull condition
    };
    
    function submitScenarioAnswer(scenarioId) {
      const answerInput = document.querySelector(`[data-question="${scenarioId}"]`);
      if (!answerInput) return;
      
      const selectedOption = document.querySelector(`input[name="${scenarioId}"]:checked`);
      if (!selectedOption) {
        alert('Please select an answer before submitting.');
        return;
      }
      
      const answer = selectedOption.value;
      scenarioAnswers[scenarioId] = answer;
      
      // Save with enhanced tracking
      worksheetTracker.saveAnswer(4, scenarioId, answer, 'diagnostic');
      
      const correctAnswer = correctAnswers[scenarioId];
      
      // Apply visual feedback
      const allOptions = answerInput.querySelectorAll('.option-label');
      
      allOptions.forEach(option => {
        const radio = option.querySelector('.option-radio');
        const optionValue = radio.value;
        
        if (optionValue === correctAnswer) {
          option.classList.add('correct');
        } else if (optionValue === answer && answer !== correctAnswer) {
          option.classList.add('incorrect');
        }
      });
      
      // Mark question as submitted to disable further interaction
      answerInput.classList.add('submitted');
      
      // Show feedback on button
      const submitBtn = answerInput.querySelector('.submit-question-btn');
      if (submitBtn) {
        const originalText = submitBtn.textContent;
        submitBtn.textContent = answer === correctAnswer ? 'Correct!' : 'Incorrect!';
        submitBtn.style.background = answer === correctAnswer ? '#4CAF50' : '#f44336';
        
        if (answer !== correctAnswer) {
          submitBtn.classList.add('incorrect');
        }
        
        setTimeout(() => {
          submitBtn.textContent = originalText;
          submitBtn.style.background = '#4CAF50';
          submitBtn.classList.remove('incorrect');
        }, 2000);
      }
      
      // Show correct answer
      const correctAnswerDiv = answerInput.querySelector('.correct-answer');
      if (correctAnswerDiv) {
        correctAnswerDiv.style.display = 'block';
      }
    }
    
    function loadSavedAnswers() {
      // This function is now handled by the tracking system
    }
  </script>
  
  <!-- Bottom Navigation -->
  <div class="worksheet-bottom-nav">
    <div class="worksheet-header-content">
      <div class="worksheet-header-left">
        <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-3.html'">
          <i class="fas fa-arrow-left"></i>
          <span>Previous Worksheet</span>
        </button>
      </div>
      <div class="worksheet-header-center">
          <h1 class="worksheet-title">Worksheet 4 - Emergency Stops</h1>
      </div>
      <div class="worksheet-header-right">
        <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-5.html'">
          <span>Next Worksheet</span>
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
  
<script>

// Enhanced answer handling functions
function submitAnswer(questionNumber) {
  const answerInput = document.querySelector(`[data-question="${questionNumber}"]`);
  if (!answerInput) return;
  
  const selectedOption = document.querySelector(`input[name="question-${questionNumber}"]:checked`);
  if (!selectedOption) {
    alert('Please select an answer before submitting.');
    return;
  }
  
  const answer = selectedOption.value;
  
  // Save with enhanced tracking if available
  if (typeof worksheetTracker !== 'undefined') {
    const worksheetId = getUrlParameter('id') || getWorksheetIdFromUrl();
    const path = window.location.pathname;
    const isFaultScenario = path.includes('fault-scenario');
    const type = getUrlParameter('type') || (isFaultScenario ? 'fault' : 'maintenance');
    worksheetTracker.saveAnswer(worksheetId, questionNumber, answer, type);
  } else {
    saveAnswer(questionNumber, answer);
  }
  
  // Get correct answer from the correct-answer div
  const correctAnswerDiv = answerInput.querySelector('.correct-answer');
  let correctAnswerText = '';
  if (correctAnswerDiv) {
    const strongElement = correctAnswerDiv.querySelector('strong');
    if (strongElement) {
      correctAnswerText = strongElement.nextSibling.textContent.trim();
    }
  }
  
  // Determine if answer is correct (extract letter from correct answer)
  const correctLetter = correctAnswerText.match(/^[A-D]/);
  const isCorrect = correctLetter && answer === correctLetter;
  
  // Style the selected option
  const allOptions = answerInput.querySelectorAll('.option-label');
  allOptions.forEach(option => {
    option.classList.remove('correct', 'incorrect');
  });
  
  if (isCorrect) {
    selectedOption.closest('.option-label').classList.add('correct');
  } else {
    selectedOption.closest('.option-label').classList.add('incorrect');
    // Also mark the correct option as correct
    const correctOption = answerInput.querySelector(`input[name="question-${questionNumber}"][value="${correctLetter}"]`);
    if (correctOption) {
      correctOption.closest('.option-label').classList.add('correct');
    }
  }
  
  const submitBtn = answerInput.querySelector('.submit-question-btn');
  if (submitBtn) {
    submitBtn.textContent = isCorrect ? 'Correct!' : 'Incorrect';
    submitBtn.style.background = isCorrect ? '#4CAF50' : '#f44336';
    setTimeout(() => {
      submitBtn.textContent = 'Submit Answer';
      submitBtn.style.background = '#4CAF50';
    }, 2000);
  }
  
  // Show correct answer
  if (correctAnswerDiv) {
    correctAnswerDiv.style.display = 'block';
  }
}


// Enhanced step tracking functions
function initializeStepTracking() {
  console.log('Initializing step tracking...');
  
  // Wait a bit to ensure DOM is ready
  setTimeout(() => {
    const stepCards = document.querySelectorAll('.step-card');
    console.log('Found', stepCards.length, 'step cards');
    
    stepCards.forEach((card, index) => {
      const checkbox = card.querySelector('.step-complete-checkbox');
      const stepNumber = card.getAttribute('data-step') || (index + 1);
      
      console.log('Setting up card', stepNumber, 'with checkbox:', !!checkbox);
      
      if (checkbox) {
        // Load saved state
        const savedState = localStorage.getItem(`step-${stepNumber}`);
        if (savedState === 'true') {
          checkbox.checked = true;
          card.classList.add('step-completed');
        }
        
        // Make the entire card clickable
        card.style.cursor = 'pointer';
        
        // Add click handler to the entire card
        card.addEventListener('click', function(e) {
          console.log('Card clicked:', stepNumber);
          
          // Don't toggle if clicking directly on the checkbox
          if (e.target === checkbox || e.target.closest('.step-checkbox')) {
            return;
          }
          
          // Toggle the checkbox
          checkbox.checked = !checkbox.checked;
          
          // Trigger change event
          const changeEvent = new Event('change', { bubbles: true });
          checkbox.dispatchEvent(changeEvent);
          
          console.log('Checkbox toggled to:', checkbox.checked);
        });
        
        // Add change handler to checkbox
        checkbox.addEventListener('change', function() {
          console.log('Checkbox changed:', stepNumber, 'checked:', checkbox.checked);
          
          if (checkbox.checked) {
            card.classList.add('step-completed');
            localStorage.setItem(`step-${stepNumber}`, 'true');
          } else {
            card.classList.remove('step-completed');
            localStorage.setItem(`step-${stepNumber}`, 'false');
          }
        });
        
        // Also make the checkbox itself clickable
        checkbox.addEventListener('click', function(e) {
          e.stopPropagation(); // Prevent card click when clicking checkbox
        });
      }
    });
  }, 100);
}

// Initialize when page loads
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeStepTracking);
} else {
  // DOM is already loaded
  initializeStepTracking();
}

// Also try again after a short delay to ensure everything is ready
setTimeout(initializeStepTracking, 500);


</script>
</body>
</html> 