<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Motor Relay</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">
  <script src="worksheet-core.js"></script>
  <script src="worksheet-tracking.js"></script>
  <script defer src="shared-navigation.js"></script>
  <script defer src="pwa-install.js"></script>

  <style>
    /* Digital Sensor Styles */
    .sensor-item {
      background: #23272b;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 15px;
      border: 1px solid #333;
      display: grid;
      grid-template-columns: auto 1fr auto;
      gap: 15px;
      align-items: center;
      position: relative;
      overflow: hidden;
    }

    .sensor-label {
      color: #aaa;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .sensor-indicator {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      position: relative;
      transition: all 0.3s ease;
    }

    .sensor-indicator.off {
      background: linear-gradient(145deg, #1a1a1a, #333);
      box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
    }

    .sensor-indicator.on {
      background: linear-gradient(145deg, #4CAF50, #388E3C);
      box-shadow: 0 0 20px rgba(76,175,80,0.4);
    }

    .sensor-indicator::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: rgba(255,255,255,0.1);
    }

    .toggle-btn {
      background: #2196F3;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .toggle-btn:hover {
      background: #1976D2;
      box-shadow: 0 0 15px rgba(33,150,243,0.3);
    }

    .plc-status {
      background: #1a1a1a;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
    }

    .plc-indicators {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-top: 15px;
    }

    .plc-input {
      background: #23272b;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      border: 1px solid #333;
    }

    .input-label {
      color: #aaa;
      display: block;
      margin-bottom: 10px;
      font-weight: bold;
    }

    .plc-indicator {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      margin: 0 auto;
      transition: all 0.3s ease;
    }

    .plc-indicator.off {
      background: linear-gradient(145deg, #1a1a1a, #333);
      box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
    }

    .plc-indicator.on {
      background: linear-gradient(145deg, #2196F3, #1976D2);
      box-shadow: 0 0 20px rgba(33,150,243,0.4);
    }

    .maintenance-btn, .fault-btn {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 5px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .maintenance-btn {
      background: #2196F3;
    }

    .maintenance-btn:hover {
      background: #1976D2;
      box-shadow: 0 0 15px rgba(33,150,243,0.3);
    }

    .fault-btn {
      background: #FF5722;
    }

    .fault-btn:hover {
      background: #F4511E;
      box-shadow: 0 0 15px rgba(255,87,34,0.3);
    }

    .task-item {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      padding: 10px;
      background: #23272b;
      border-radius: 5px;
      cursor: pointer;
    }

    .task-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }

    .task-item label {
      color: #aaa;
      cursor: pointer;
      flex: 1;
    }

    .diagnostic-log {
      background: #23272b;
      padding: 15px;
      border-radius: 5px;
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      color: #aaa;
      margin-top: 10px;
    }

    .diagnostic-log p {
      margin: 5px 0;
      padding: 5px;
      border-radius: 3px;
      transition: background-color 0.3s ease;
    }

    .diagnostic-log p:hover {
      background: rgba(255,255,255,0.05);
    }

    .timestamp {
      color: #666;
      margin-right: 10px;
    }

    /* Wiring Diagram */
    .wiring-diagram {
      background: #23272b;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      position: relative;
      height: 200px;
      overflow: hidden;
    }

    .wire {
      position: absolute;
      background: #444;
      transition: all 0.3s ease;
    }

    .wire.active {
      background: #2196F3;
      box-shadow: 0 0 10px rgba(33,150,243,0.4);
    }

    .wire.fault {
      background: #FF5722;
      box-shadow: 0 0 10px rgba(255,87,34,0.4);
    }

    .connection-point {
      position: absolute;
      width: 12px;
      height: 12px;
      background: #666;
      border-radius: 50%;
      border: 2px solid #444;
      transition: all 0.3s ease;
    }

    .connection-point.active {
      background: #2196F3;
      border-color: #1976D2;
      box-shadow: 0 0 10px rgba(33,150,243,0.4);
    }

    .connection-point.fault {
      background: #FF5722;
      border-color: #F4511E;
      box-shadow: 0 0 10px rgba(255,87,34,0.4);
    }
  </style>
</head>
<body>


  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-11.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Previous Worksheet</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Worksheet 12 - Motor Relay</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='CP2388-worksheets.html'">
            <span>Back to Worksheets</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> 1. Introduction</h2>
      <div class="worksheet-content">
        <div class="introduction-content-wrapper">
          <div class="introduction-text">
            <p>Relays are electrically operated switches that allow a PLC to control higher-power devices safely. The PLC energises a low-power coil, which activates internal contacts to switch outputs on or off. This worksheet helps you understand how relays isolate and control output devices like motors or solenoids.</p>
          </div>
          <div class="introduction-image">
            <div class="system-diagram">
              <img src="assets/maintenance/digital-sensors.png" alt="Digital Sensors System Maintenance">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Over To You Section -->
    <div class="worksheet-section over-to-you-section">
      <h2 class="section-header"><i class="fas fa-hands-helping"></i> 2. Over To You</h2>
      <div class="worksheet-content">
        <p><strong>Follow these steps to explore relays:</strong></p>

        <div class="steps-container">
          <div class="step-card" data-step="1">
            <div class="step-number">1</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Open Worksheet 12</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Press the green I0 button to energise the relay. Observe the relay LED when the coil is on.</p>
            </div>
          </div>

          <div class="step-card" data-step="2">
            <div class="step-number">2</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Stop with I2</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Press the red button I2 and confirm the relay de-energises and the output device stops.</p>
            </div>
          </div>

          <div class="step-card" data-step="3">
            <div class="step-number">3</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Auto Trip via Potentiometer</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Rotate the potentiometer slowly. At around 50%, the relay should activate automatically. Observe the output only runs when the relay is energised.</p>
            </div>
          </div>

          <div class="step-card" data-step="4">
            <div class="step-number">4</div>
            <div class="step-content">
              <div class="step-header">
                <h4>E-Stop Check</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Press the Emergency Stop and confirm the relay de-energises.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- So What Section -->
    <div class="worksheet-section so-what-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> 3. So What?</h2>
      <div class="so-what-content">
        <div class="explanation-card">
          <div class="card-header">
            <i class="fas fa-cogs"></i>
            <h3>Why this matters</h3>
          </div>
          <div class="card-content">
            <p>In real systems, PLC outputs can’t always drive motors or solenoids directly. Relays bridge low-power PLC control and higher-power loads, and provide isolation. You’ll diagnose stuck contacts, faulty coils, or incorrect logic in the field.</p>
            <h3 style="margin-top:16px;">Key Takeaways</h3>
            <ul>
              <li>Relays let PLCs safely switch higher-power devices.</li>
              <li>PLC energises a coil; contacts switch the load.</li>
              <li>Relays provide electrical isolation.</li>
              <li>Status LEDs on relays/HMI help diagnosis.</li>
            </ul>
          </div>
        </div>
      </div>

    </div>

    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-question-circle"></i> Questions & Answers</h2>
      <div class="questions-content">
        <div class="question-item" data-question="1">
          <h4>Question 1: What type of signal does a digital sensor send to a PLC?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-1" value="A" class="option-radio">
              <span class="option-text">A) A digital sensor sends a simple on/off signal, usually using 24V DC</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="B" class="option-radio">
              <span class="option-text">B) A digital sensor sends a continuous analog signal</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="C" class="option-radio">
              <span class="option-text">C) A digital sensor sends a wireless signal</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="D" class="option-radio">
              <span class="option-text">D) A digital sensor sends a fiber optic signal</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(1)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) A digital sensor sends a simple on/off signal, usually using 24V DC.
          </div>
        </div>
        
        <div class="question-item" data-question="2">
          <h4>Question 2: How can you monitor the status of a digital input?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-2" value="A" class="option-radio">
              <span class="option-text">A) You can view the input status directly on the PLC or on the IO screen of the HMI</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="B" class="option-radio">
              <span class="option-text">B) You can only monitor it with a multimeter</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="C" class="option-radio">
              <span class="option-text">C) You can only monitor it with an oscilloscope</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="D" class="option-radio">
              <span class="option-text">D) You cannot monitor digital inputs</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(2)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) You can only monitor it with a multimeter.
          </div>
        </div>
        
        <div class="question-item" data-question="3">
          <h4>Question 3: What is the difference between a Normally Open (NO) and Normally Closed (NC) sensor?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-3" value="A" class="option-radio">
              <span class="option-text">A) A NO sensor sends a signal only when triggered, while an NC sensor sends a signal when idle and stops when triggered</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="B" class="option-radio">
              <span class="option-text">B) A NO sensor is always on, an NC sensor is always off</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="C" class="option-radio">
              <span class="option-text">C) A NO sensor measures temperature, an NC sensor measures pressure</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="D" class="option-radio">
              <span class="option-text">D) There is no difference between them</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(3)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> D) There is no difference between them.
          </div>
        </div>
        
        <div class="question-item" data-question="4">
          <h4>Question 4: Why are Emergency Stop buttons typically wired as Normally Closed (NC)?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-4" value="A" class="option-radio">
              <span class="option-text">A) So that if a wire breaks or becomes disconnected, the system sees it as a fault and shuts down for safety</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="B" class="option-radio">
              <span class="option-text">B) So they are easier to install</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="C" class="option-radio">
              <span class="option-text">C) So they use less power</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="D" class="option-radio">
              <span class="option-text">D) So they are cheaper to manufacture</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(4)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) So they use less power.
          </div>
        </div>
        
        <div class="question-item" data-question="5">
          <h4>Question 5: Can you name the seven digital inputs used in the training system?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-5" value="A" class="option-radio">
              <span class="option-text">A) Flow sensor, tank high switch, tank low switch, tank lid proximity switch, two E-Stop channels, and the blue reset switch</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="B" class="option-radio">
              <span class="option-text">B) E-Stop Ch1, E-Stop Ch2, Reset Button, Tank High Float [NC], Tank Low Float [NO], Tank Cover Switch.</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="C" class="option-radio">
              <span class="option-text">C) Flow sensor, temperature sensor, pressure sensor, level sensor, valve position, pump status, and reset switch</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="D" class="option-radio">
              <span class="option-text">D) Flow sensor, temperature sensor, pressure sensor, level sensor, valve position, pump status, and E-Stop</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(5)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) E-Stop Ch1, E-Stop Ch2, Reset Button, Tank High Float [NC], Tank Low Float [NO], Tank Cover Switch.
          </div>
        </div>
      </div>
    </div>

    <!-- Simulation Section -->
    <div class="simulation-section">
      <h2 class="section-header"><i class="fas fa-cogs"></i> 3. Interactive Digital Sensors System Maintenance</h2>
      <div id="digital-sensors-panel" class="simulation-container">
        <div class="simulation-loading">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading digital sensors simulation...</p>
          </div>
        </div>

        <!-- Key Learning Points Card -->
        <div class="key-points-card">
          <div class="card-header">
            <i class="fas fa-lightbulb"></i>
            <h3>Key Learning Points</h3>
          </div>
          <div class="key-points-grid">
            <div class="key-point-item">
              <div class="key-point-icon">
                <i class="fas fa-cogs"></i>
              </div>
              <div class="key-point-content">
                <strong>Simulation will initialize automatically</p>
        </div>
      </div>
    </div>
  </div>



  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="digital-sensors-simulation.js"></script>
  
  <script>
    // Define correct answers for worksheet 12
    const correctAnswers = {
      "1": "A",
      "2": "B",
      "3": "D",
      "4": "C",
      "5": "B"
    };

    function submitAnswer(questionNumber) {
      const questionItem = document.querySelector(`[data-question="${questionNumber}"]`);
      if (!questionItem) return;
      
      const selectedOption = questionItem.querySelector('.option-radio:checked');
      if (!selectedOption) {
        alert('Please select an answer before submitting.');
        return;
      }
      
      const answer = selectedOption.value;
      
      // Save with enhanced tracking
      worksheetTracker.saveAnswer(12, questionNumber, answer, 'maintenance');
      
      // Apply visual feedback
      const allOptions = questionItem.querySelectorAll('.option-label');
      const correctAnswer = correctAnswers[questionNumber];
      
      allOptions.forEach(option => {
        const radio = option.querySelector('.option-radio');
        const optionValue = radio.value;
        
        if (optionValue === correctAnswer) {
          option.classList.add('correct');
        } else if (optionValue === answer && answer !== correctAnswer) {
          option.classList.add('incorrect');
        }
      });
      
      // Mark question as submitted to disable further interaction
      questionItem.classList.add('submitted');
      
      // Update submit button
      const button = questionItem.querySelector('.submit-question-btn');
      const originalText = button.textContent;
      button.textContent = answer === correctAnswer ? 'Correct!' : 'Incorrect!';
      button.style.background = answer === correctAnswer ? '#4CAF50' : '#f44336';
      
      // Add incorrect class for enhanced styling
      if (answer !== correctAnswer) {
        button.classList.add('incorrect');
      }
      
      setTimeout(() => {
        button.textContent = originalText;
        button.style.background = '#4CAF50';
        button.classList.remove('incorrect');
      }, 2000);

      // Show correct answer
      const correctAnswerDiv = questionItem.querySelector('.correct-answer');
      if (correctAnswerDiv) {
        correctAnswerDiv.style.display = 'block';
      }
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize tracking system
      if (typeof worksheetTracker === 'undefined') {
        console.error('Worksheet tracking system not loaded');
        return;
      }

      // Load any saved answers
      const progress = worksheetTracker.getWorksheetProgress(12, 'maintenance');
      if (progress && progress.answers) {
        Object.entries(progress.answers).forEach(([questionNumber, answerData]) => {
          const questionItem = document.querySelector(`[data-question="${questionNumber}"]`);
          if (questionItem) {
            const radio = questionItem.querySelector(`.option-radio[value="${answerData.value}"]`);
            if (radio) {
              radio.checked = true;
              // Show the correct answer for previously answered questions
              const correctAnswerDiv = questionItem.querySelector('.correct-answer');
              if (correctAnswerDiv) {
                correctAnswerDiv.style.display = 'block';
              }
            }
          }
        });
      }
    });
  </script>
  
  <!-- Bottom Navigation -->
  <div class="worksheet-bottom-nav">
    <div class="worksheet-header-content">
      <div class="worksheet-header-left">
        <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-11.html'">
          <i class="fas fa-arrow-left"></i>
          <span>Previous Worksheet</span>
        </button>
      </div>
       <div class="worksheet-header-center">
       <h1 class="worksheet-title">Worksheet 12 - Motor Relay</h1>
      </div>
      <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='CP2388-worksheets.html'">
            <span>Back to Worksheets</span>
            <i class="fas fa-chevron-right"></i>
          </button>
      </div>
    </div>
  </div>
  
<script>

// Enhanced answer handling functions
function submitAnswer(questionNumber) {
  const answerInput = document.querySelector(`[data-question="${questionNumber}"]`);
  if (!answerInput) return;
  
  const selectedOption = document.querySelector(`input[name="question-${questionNumber}"]:checked`);
  if (!selectedOption) {
    alert('Please select an answer before submitting.');
    return;
  }
  
  const answer = selectedOption.value;
  
  // Save with enhanced tracking if available
  if (typeof worksheetTracker !== 'undefined') {
    const worksheetId = getUrlParameter('id') || getWorksheetIdFromUrl();
    const path = window.location.pathname;
    const isFaultScenario = path.includes('fault-scenario');
    const type = getUrlParameter('type') || (isFaultScenario ? 'fault' : 'maintenance');
    worksheetTracker.saveAnswer(worksheetId, questionNumber, answer, type);
  } else {
    saveAnswer(questionNumber, answer);
  }
  
  // Get correct answer from the correct-answer div
  const correctAnswerDiv = answerInput.querySelector('.correct-answer');
  let correctAnswerText = '';
  if (correctAnswerDiv) {
    const strongElement = correctAnswerDiv.querySelector('strong');
    if (strongElement) {
      correctAnswerText = strongElement.nextSibling.textContent.trim();
    }
  }
  
  // Determine if answer is correct (extract letter from correct answer)
  const correctLetter = correctAnswerText.match(/^[A-D]/);
  const isCorrect = correctLetter && answer === correctLetter;
  
  // Style the selected option
  const allOptions = answerInput.querySelectorAll('.option-label');
  allOptions.forEach(option => {
    option.classList.remove('correct', 'incorrect');
  });
  
  if (isCorrect) {
    selectedOption.closest('.option-label').classList.add('correct');
  } else {
    selectedOption.closest('.option-label').classList.add('incorrect');
    // Also mark the correct option as correct
    const correctOption = answerInput.querySelector(`input[name="question-${questionNumber}"][value="${correctLetter}"]`);
    if (correctOption) {
      correctOption.closest('.option-label').classList.add('correct');
    }
  }
  
  const submitBtn = answerInput.querySelector('.submit-question-btn');
  if (submitBtn) {
    submitBtn.textContent = isCorrect ? 'Correct!' : 'Incorrect';
    submitBtn.style.background = isCorrect ? '#4CAF50' : '#f44336';
    setTimeout(() => {
      submitBtn.textContent = 'Submit Answer';
      submitBtn.style.background = '#4CAF50';
    }, 2000);
  }
  
  // Show correct answer
  if (correctAnswerDiv) {
    correctAnswerDiv.style.display = 'block';
  }
}


// Enhanced step tracking functions
function initializeStepTracking() {
  console.log('Initializing step tracking...');
  
  // Wait a bit to ensure DOM is ready
  setTimeout(() => {
    const stepCards = document.querySelectorAll('.step-card');
    console.log('Found', stepCards.length, 'step cards');
    
    stepCards.forEach((card, index) => {
      const checkbox = card.querySelector('.step-complete-checkbox');
      const stepNumber = card.getAttribute('data-step') || (index + 1);
      
      console.log('Setting up card', stepNumber, 'with checkbox:', !!checkbox);
      
      if (checkbox) {
        // Load saved state
        const savedState = localStorage.getItem(`step-${stepNumber}`);
        if (savedState === 'true') {
          checkbox.checked = true;
          card.classList.add('step-completed');
        }
        
        // Make the entire card clickable
        card.style.cursor = 'pointer';
        
        // Add click handler to the entire card
        card.addEventListener('click', function(e) {
          console.log('Card clicked:', stepNumber);
          
          // Don't toggle if clicking directly on the checkbox
          if (e.target === checkbox || e.target.closest('.step-checkbox')) {
            return;
          }
          
          // Toggle the checkbox
          checkbox.checked = !checkbox.checked;
          
          // Trigger change event
          const changeEvent = new Event('change', { bubbles: true });
          checkbox.dispatchEvent(changeEvent);
          
          console.log('Checkbox toggled to:', checkbox.checked);
        });
        
        // Add change handler to checkbox
        checkbox.addEventListener('change', function() {
          console.log('Checkbox changed:', stepNumber, 'checked:', checkbox.checked);
          
          if (checkbox.checked) {
            card.classList.add('step-completed');
            localStorage.setItem(`step-${stepNumber}`, 'true');
          } else {
            card.classList.remove('step-completed');
            localStorage.setItem(`step-${stepNumber}`, 'false');
          }
        });
        
        // Also make the checkbox itself clickable
        checkbox.addEventListener('click', function(e) {
          e.stopPropagation(); // Prevent card click when clicking checkbox
        });
      }
    });
  }, 100);
}

// Initialize when page loads
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeStepTracking);
} else {
  // DOM is already loaded
  initializeStepTracking();
}

// Also try again after a short delay to ensure everything is ready
setTimeout(initializeStepTracking, 500);


</script>
</body>
</html> 